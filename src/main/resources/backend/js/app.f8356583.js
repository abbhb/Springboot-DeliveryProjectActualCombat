(function(e){function t(t){for(var s,o,i=t[0],l=t[1],c=t[2],d=0,m=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&m.push(r[o][0]),r[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);u&&u(t);while(m.length)m.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],s=!0,i=1;i<a.length;i++){var l=a[i];0!==r[l]&&(s=!1)}s&&(n.splice(t--,1),e=o(o.s=a[0]))}return e}var s={},r={app:0},n=[];function o(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=s,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/backend/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"1bcf":function(e,t,a){},"21af":function(e,t,a){},"22f2":function(e,t,a){"use strict";var s=a("ac2f"),r=a.n(s);r.a},2940:function(e,t,a){"use strict";var s=a("1bcf"),r=a.n(s);r.a},"2b00":function(e,t,a){},"32b8":function(e,t,a){"use strict";var s=a("559b"),r=a.n(s);r.a},"350f":function(e,t,a){},"36a0":function(e,t,a){"use strict";var s=a("5b90"),r=a.n(s);r.a},"3ad2":function(e,t,a){},4703:function(e,t,a){},"559b":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},n=[],o={created:function(){this.$globl.isNeedZoom&&.9!=document.body.style.zoom&&(document.body.style.zoom=.9)}},i=o,l=(a("5c0b"),a("2877")),c=Object(l["a"])(i,r,n,!1,null,null,null),u=c.exports,d=(a("caad"),a("a9e3"),a("2532"),a("8c4f")),m=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},p=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("你没有权限访问!")])])}],g=(a("96cf"),a("1da1")),h=(a("b0c0"),a("bc3a")),f=a.n(h);a("d3b7"),a("ac1f"),a("5319");function v(e){e.interceptors.request.use((function(e){return e.headers["Content-Type"]="application/json",e.headers.Authorization=localStorage.getItem("token"),e.headers.type="back",e.headers.userid=localStorage.getItem("userid"),e}),(function(e){Promise.reject(e)})),e.interceptors.response.use((function(e){switch(console.log(e),e.data.status){case 900:sessionStorage.clear(),localStorage.clear(),bt.replace({path:"/login",query:{redirect:bt.currentRoute.value.fullPath}})}switch(e.status){case 401:sessionStorage.clear(),localStorage.clear(),bt.replace({path:"/login",query:{redirect:bt.currentRoute.fullPath}})}return e.data}),(function(e){switch(e.response.status){case 400:e.message="请求错误(400)";break;case 401:e.message="未授权，请重新登录(401)",sessionStorage.clear(),localStorage.clear(),bt.replace({path:"/login",query:{redirect:bt.currentRoute.fullPath}});break;case 900:e.message="未授权，请重新登录(900)",sessionStorage.clear(),localStorage.clear(),bt.replace({path:"/login",query:{redirect:bt.currentRoute.fullPath}});break;case 403:e.message="拒绝访问(403)";break;case 404:e.message="请求出错(404)";break;case 408:e.message="请求超时(408)";break;case 500:e.message="服务器错误(500)";break;case 501:e.message="服务未实现(501)";break;case 502:e.message="网络错误(502)";break;case 503:e.message="服务不可用(503)";break;case 504:e.message="网络超时(504)";break;case 505:e.message="HTTP版本不受支持(505)";break}}))}var b=f.a.create({baseURL:"/api",timeout:2e4});v(b);var S=b;function y(e,t){return S({url:"/employee/login",method:"post",data:{username:e,password:t}})}function w(){return S({url:"/employee/logout",method:"post"})}function x(e){return S({url:"/category/deletecategory",method:"post",data:{id:e}})}function k(){return S({url:"/employee/loginbytoken",method:"post",data:{}})}function I(e,t,a){return S({url:"/order/listForAdmin",method:"get",params:{pageNum:e,pageSize:t,storeId:a}})}function _(e,t,a,s,r,n){return S({url:"/employee/updataforuser",method:"post",data:{id:String(e),username:String(t),name:String(a),sex:String(s),idNumber:String(r),phone:String(n)}})}function C(e,t,a){return S({url:"/store/get",method:"get",params:{pageNum:e,pageSize:t,name:a}})}function D(e,t,a){return S({url:"/employee/get",method:"get",params:{pageNum:e,pageSize:t,name:a}})}function N(e,t,a,s){return S({url:"/dish/get",method:"get",params:{pageNum:e,pageSize:t,storeId:a,name:s}})}function F(e,t,a){return S({url:"/dish/get/listbycategory",method:"get",params:{categoryId:void 0==e?void 0:e,storeId:t,name:""==a?void 0:a}})}function $(e,t,a,s){return S({url:"/setmeal/get",method:"get",params:{pageNum:e,pageSize:t,storeId:a,name:s}})}function O(e){return S({url:"/dish/put",method:"put",params:e})}function L(e){return S({url:"/setmeal/put",method:"put",params:e})}function B(e){return S({url:"/dish/del",method:"delete",params:e})}function z(e){return S({url:"/setmeal/del",method:"delete",params:e})}function R(e){return S({url:"/dish/get/flavor",method:"get",params:e})}function j(e){return S({url:"/setmeal/get/dish",method:"get",params:e})}function T(e){return S({url:"/setmeal/get/flavor",method:"get",params:e})}function A(e,t,a){return S({url:"/store/updatastorestatus",method:"post",data:{userId:e,storeId:t,storeStatus:a}})}function H(e,t,a){return S({url:"/employee/updataemployeestatus",method:"post",data:{userId:String(e),caozuoId:String(t),userStatus:String(a)}})}function q(e,t){return S({url:"/store/deletestore",method:"post",data:{userId:e,storeId:t}})}function V(e,t){return S({url:"/employee/deleteemployee",method:"post",data:{userId:e,caozuoId:t}})}function E(){return S({url:"/store/getstorelistonlyidwithname",method:"get",params:{}})}function U(){return S({url:"/employee/getemployeelistonlyidwithname",method:"get",params:{}})}function Q(e,t,a,s){return S({url:"/category/save",method:"post",data:{type:e,name:t,sort:a,storeId:s}})}function M(e){return S({url:"/setmeal/add",method:"post",data:e})}function J(e,t,a,s){return S({url:"/category/updata",method:"post",data:{id:e,type:t,name:a,sort:s}})}function P(e,t,a){return S({url:"/category/getcategorypage",method:"post",data:{pageNum:e,pageSize:t,storeId:a}})}function W(e,t){return S({url:"/category/getcategorylablevaluelist",method:"post",data:{storeId:e,type:t}})}function K(e,t,a,s,r,n,o,i,l){return S({url:"/dish/add",method:"post",data:{name:e,categoryId:t,price:a,image:s,description:r,status:n,sort:o,storeId:i,dishFlavors:l}})}function Z(e){return S({url:"/setmeal/edit",method:"post",data:e})}function X(e,t,a,s,r,n,o,i,l,c,u){return S({url:"/dish/edit",method:"post",data:{id:c,name:e,categoryId:t,price:a,image:s,description:r,status:n,sort:o,storeId:i,dishFlavors:l,version:u}})}function G(e,t,a,s,r){return S({url:"/employee/changepassword",method:"post",data:{id:String(e),username:String(t),password:String(a),newpassword:String(s),checknewpassword:String(r)}})}function Y(e,t,a,s){return S({url:"/store/add",method:"post",data:{userId:String(e),storeName:String(t),storeIntroduction:String(a),storeStatus:String(s)}})}function ee(e,t,a,s,r){return S({url:"/store/updata",method:"post",data:{userId:String(e),storeId:String(t),storeName:String(a),storeIntroduction:String(s),storeStatus:String(r)}})}function te(e){return S({url:"/employee/add",method:"post",data:{name:String(e.name),username:String(e.username),phone:String(e.phone),idNumber:String(e.idNumber),status:String(e.status),permissions:e.permissions,storeId:e.storeId,sex:String(e.sex),password:String(e.password)}})}function ae(e){return S({url:"/store/getstorebyid",method:"post",data:{storeid:String(e)}})}function se(e,t){return S({url:"/employee/updataemployee",method:"post",data:{userid:String(t),name:String(e.name),username:String(e.username),phone:String(e.phone),idNumber:String(e.idNumber),status:String(e.status),permissions:e.permissions,storeId:e.storeId,sex:String(e.sex)}})}var re={name:"NotFound",data:function(){return{}},created:function(){return Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:t=e.sent,"1"===String(t.code)?(console.log("验证"),localStorage.setItem("type",t.data.permissions),localStorage.setItem("userInfo",JSON.stringify(t.data)),localStorage.setItem("userid",String(t.data.id)),"1"===String(t.data.permissions)||"2"===String(t.data.permissions)?bt.push({name:"index"}):"null"===String(t.data.storeId)?bt.push({name:"404NotFound"}):bt.push({name:"index"})):sessionStorage.setItem("userLastStoreId","");case 4:case"end":return e.stop()}}),e)})))()},methods:{}},ne=re,oe=Object(l["a"])(ne,m,p,!1,null,"416927df",null),ie=oe.exports,le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("header",{staticClass:"header"},[a("div",{staticClass:"left"},[e._v(" N外卖管理后台 "),a("el-button",{attrs:{circle:"",icon:e.menuCollapse?"el-icon-s-unfold":"el-icon-s-fold"},on:{click:e.onMenuCollapse}})],1),a("div",{staticClass:"right",staticStyle:{display:"flex","flex-direction":"row","align-items":"center"}},[a("div",{staticStyle:{"margin-right":"30px","font-size":"12px",color:"rgba(255,255,255,0.78)"}},[a("el-link",{nativeOn:{click:function(t){return e.setIsNeedZoom(t)}}},[e._v("显示异常?点击修复视图")])],1),a("div",{staticClass:"warp",staticStyle:{"margin-right":"auto"}},[a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[a("el-avatar",{attrs:{shape:"circle",size:40,src:e.userphoto}})],1),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[e._v(e._s(e.name))]),a("el-dropdown-item",[e._v("切换账号")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.onLogOut(t)}}},[e._v("退出登录")])],1)],1)],1)])]),a("section",{staticClass:"section"},[a("div",{staticClass:"tac"},[a("div",{staticClass:"col1"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"2",collapse:e.menuCollapse,"unique-opened":!0,"default-openeds":e.defaultUnfoldedMenu,select:"1-1","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{open:e.handleOpen,close:e.handleClose}},e._l(e.menuData,(function(t){return a("div",{key:t.index},[t.childList&&t.childList.length>0?a("el-submenu",{attrs:{index:t.index}},[a("template",{slot:"title"},[a("i",{class:t.iconClassName}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.menuCollapse?"":t.optionName))])]),e._l(t.childList,(function(t){return a("el-menu-item",{key:t.index,attrs:{index:t.index,routerName:t.routerName},on:{click:function(a){return e.onClickMenu(t)}}},[a("template",{slot:"title"},[a("i",{class:t.iconClassName}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.menuCollapse?"":t.optionName))])])],2)}))],2):a("el-menu-item",{attrs:{index:t.index,disabled:t.disabled,routerName:t.routerName},on:{click:function(a){return e.onClickMenu(t)}}},[a("i",{class:t.iconClassName}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.menuCollapse?"":t.optionName))])])],1)})),0)],1),a("div",{staticClass:"col2"},[a("header",{staticClass:"col2_header"},e._l(e.tags,(function(t){return a("el-tag",{key:t.routerName,staticClass:"item",attrs:{closable:"",type:t.type?t.type:"info"},on:{close:function(a){return e.close(t)},click:function(a){return e.clickTag(t)}}},[e._v(e._s(t.name))])})),1),a("div",{staticClass:"warp"},[a("router-view")],1)])])])])},ce=[],ue=(a("7db0"),a("c740"),a("4160"),a("a434"),a("159b"),{name:"index",data:function(){return{menuData:[{optionName:"我的主页",iconClassName:"el-icon-eleme",index:"1",disabled:!1,childList:[{optionName:"个人信息",index:"1-1",routerName:"userinfo",iconClassName:"el-icon-user"},{optionName:"修改密码",index:"1-4",routerName:"changepassword",iconClassName:"el-icon-lock"}]},{optionName:"门店管理",iconClassName:"el-icon-setting",index:"2",disabled:!1,childList:[{optionName:"管理门店",index:"2-1",routerName:"mendianguanli",iconClassName:"el-icon-s-shop"},{optionName:"员工管理",index:"2-2",routerName:"memberguanli",iconClassName:"el-icon-s-custom"},{optionName:"分类管理",index:"2-3",routerName:"category",iconClassName:"el-icon-folder"},{optionName:"菜品管理",index:"2-4",routerName:"food",iconClassName:"el-icon-dish"},{optionName:"套餐管理",index:"2-5",routerName:"combo",iconClassName:"el-icon-goods"},{optionName:"订单明细",index:"2-6",routerName:"orders",iconClassName:"el-icon-s-order"}]}],menuCollapse:!1,defaultUnfoldedMenu:"1",tags:[],userphoto:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",showPhotoMenu:!1,name:"11",userInfo:{}}},created:function(){this.defaultUnfoldedMenu=[localStorage.getItem("defaultUnfoldedMenu")],this.menuCollapse=JSON.parse(localStorage.getItem("menuCollapse")),this.tags=JSON.parse(localStorage.getItem("tagsNavList"))||[];var e=window.localStorage.getItem("userInfo");e&&(this.userInfo=JSON.parse(e)),this.name=this.userInfo.name},methods:{onMenuCollapse:function(){this.menuCollapse=!this.menuCollapse,localStorage.setItem("menuCollapse",this.menuCollapse),this.defaultUnfoldedMenu=[localStorage.getItem("defaultUnfoldedMenu")]},handleOpen:function(e,t){console.log(e,t),localStorage.setItem("defaultUnfoldedMenu",""+e)},handleClose:function(e,t){console.log(e,t)},onClickMenu:function(e){var t=this;if(this.$router.history.current.name!=e.routerName){this.$router.push({name:e.routerName});var a=s(e.routerName);if(a)return this.tags.forEach((function(e){e.type="info"})),void(a.type="success");this.tags.forEach((function(e){e.type="info"})),this.tags.push({name:e.optionName,routerName:e.routerName,type:"success"}),this.changeTagColor(e.routerName),localStorage.setItem("tagsNavList",JSON.stringify(this.tags))}function s(e){var a=t.tags;return a.find((function(t){return t.routerName==e}))}},clickTag:function(e){console.log(e.routerName),this.$router.history.current.name!=e.routerName&&(this.$router.push({name:e.routerName}),this.changeTagColor(e.routerName),localStorage.setItem("tagsNavList",JSON.stringify(this.tags)))},close:function(e){console.log(e);var t=this.tags.findIndex((function(t){return t.routerName==e.routerName}));console.log(t),this.tags.splice(t,1),localStorage.setItem("tagsNavList",JSON.stringify(this.tags))},changeTagColor:function(e){this.tags.forEach((function(t){t.routerName==e?t.type="success":t.type="info"}))},setIsNeedZoom:function(){this.$globl.isNeedZoom=!0,document.body.style.zoom=.9},onLogOut:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w();case 2:a=t.sent,console.log(a),"900"===String(a.code)?(e.$message.success(a.msg),sessionStorage.clear(),localStorage.clear(),e.$router.push("login")):701===a.status&&e.$message.error(a.msg);case 5:case"end":return t.stop()}}),t)})))()}}}),de=ue,me=(a("36a0"),Object(l["a"])(de,le,ce,!1,null,"b1df3366",null)),pe=me.exports,ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login",attrs:{id:"login-app"}},[a("div",{staticClass:"login-box"},[a("img",{attrs:{src:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",alt:""}}),a("div",{staticClass:"login-form"},[a("el-form",{ref:"loginForm",attrs:{model:e.loginForm,rules:e.loginRules}},[a("div",{staticClass:"login-form-title"},[a("span",[e._v("N外卖")])]),a("el-form-item",{attrs:{prop:"username"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"账号",maxlength:"20","prefix-icon":"iconfont icon-user"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"密码","prefix-icon":"iconfont icon-lock",maxlength:"20"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticClass:"login-btn",staticStyle:{width:"100%"},attrs:{loading:e.loading,size:"medium",type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e.loading?a("span",[e._v("登录中...")]):a("span",[e._v("登录")])])],1)],1)],1)])])},he=[],fe={name:"login",el:"#login-app",data:function(){return{loginForm:{username:"admin",password:"123456"},loading:!1}},computed:{loginRules:function(){var e=function(e,t,a){t.length<1?a(new Error("请输入用户名")):a()},t=function(e,t,a){t.length<6?a(new Error("密码必须在6位以上")):a()};return{username:[{validator:e,trigger:"blur"}],password:[{validator:t,trigger:"blur"}]}}},created:function(){this.checkToken()},methods:{handleLogin:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.loginForm.validate(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=6;break}return e.loading=!0,t.next=4,y(e.loginForm.username,e.loginForm.password);case 4:s=t.sent,"1"===String(s.code)?(localStorage.setItem("userInfo",JSON.stringify(s.data)),localStorage.setItem("type",s.data.permissions),localStorage.setItem("userid",String(s.data.id)),localStorage.setItem("token",s.data.token),"1"===String(s.data.permissions)||"2"===String(s.data.permissions)?bt.push({name:"index"}):"null"===String(s.data.storeId)?bt.push({name:"404NotFound"}):bt.push({name:"index"})):(e.$message.error(s.msg),sessionStorage.setItem("userLastStoreId",""),e.loading=!1);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},checkToken:function(){return Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:t=e.sent,"1"===String(t.code)?(console.log("验证"),localStorage.setItem("type",t.data.permissions),localStorage.setItem("userInfo",JSON.stringify(t.data)),localStorage.setItem("userid",String(t.data.id)),"1"===String(t.data.permissions)||"2"===String(t.data.permissions)?bt.push({name:"index"}):"null"===String(t.data.storeId)?bt.push({name:"404NotFound"}):bt.push({name:"index"})):sessionStorage.setItem("userLastStoreId","");case 4:case"end":return e.stop()}}),e)})))()}}},ve=fe,be=(a("32b8"),Object(l["a"])(ve,ge,he,!1,null,"12bb5caf",null)),Se=be.exports,ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card"},[a("el-form",{attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{rules:[{required:!0,message:"id is required"}],label:"id"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),a("el-form-item",{attrs:{rules:[{required:!0,message:"用户名 is required"}],label:"用户名"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("el-form-item",{attrs:{rules:[{required:!0,message:"昵称 is required"}],label:"昵称"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{rules:[{required:!0,message:"性别 is required"}],label:"性别"}},[a("el-select",{attrs:{placeholder:"请选择你的性别"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[a("el-option",{attrs:{label:"男",value:"男"}}),a("el-option",{attrs:{label:"女",value:"女"}})],1)],1),a("el-form-item",{attrs:{rules:[{required:!0,message:"idNumber is required"},{type:"number",message:"idNumber must be a number"}],label:"身份证号码"}},[a("el-input",{model:{value:e.form.idNumber,callback:function(t){e.$set(e.form,"idNumber",t)},expression:"form.idNumber"}})],1),a("el-form-item",{attrs:{rules:[{required:!0,message:"手机号码必须填写"},{type:"number",message:"手机号码必须是数字"}],label:"手机号码"}},[a("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",disabled:e.form_serve.id===e.form.id&&e.form_serve.username===e.form.username&&e.form_serve.name===e.form.name&&e.form_serve.sex===e.form.sex&&e.form_serve.idNumber===e.form.idNumber&&e.form_serve.phone===e.form.phone},on:{click:e.onSubmit}},[e._v("更新")]),a("el-button",{on:{click:e.reWrite}},[e._v("重置")])],1)],1)],1)],1)},we=[],xe={name:"UserInfo",data:function(){return{form:{id:"",username:"",name:"",sex:"",idNumber:"",phone:""},form_serve:{id:"",username:"",name:"",sex:"",idNumber:"",phone:""},userInfo:{}}},created:function(){this.init()},methods:{reWrite:function(){this.form.name=this.userInfo.name,this.form.phone=this.userInfo.phone,this.form.sex=this.userInfo.sex,this.form.username=this.userInfo.username,this.form.idNumber=this.userInfo.idNumber,this.form.id=this.userInfo.id,this.form_serve.name=this.userInfo.name,this.form_serve.phone=this.userInfo.phone,this.form_serve.sex=this.userInfo.sex,this.form_serve.username=this.userInfo.username,this.form_serve.idNumber=this.userInfo.idNumber,this.form_serve.id=this.userInfo.id},init:function(){var e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t=localStorage.getItem("userInfo");t?(this.userInfo=JSON.parse(t),this.form.name=this.userInfo.name,this.form.phone=this.userInfo.phone,this.form.sex=this.userInfo.sex,this.form.username=this.userInfo.username,this.form.idNumber=this.userInfo.idNumber,this.form.id=this.userInfo.id,this.form_serve.name=this.userInfo.name,this.form_serve.phone=this.userInfo.phone,this.form_serve.sex=this.userInfo.sex,this.form_serve.username=this.userInfo.username,this.form_serve.idNumber=this.userInfo.idNumber,this.form_serve.id=this.userInfo.id,e.close()):this.$message.error("数据错误,请刷新重试!")},onSubmit:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,_(a.form.id,a.form.username,a.form.name,a.form.sex,a.form.idNumber,a.form.phone);case 3:if(s=t.sent,"1"!==String(s.code)){t.next=12;break}return a.$message.success(s.msg),t.next=8,k();case 8:r=t.sent,"1"===String(r.code)?(localStorage.setItem("userInfo",JSON.stringify(r.data)),a.init()):(e.$message.error(r.msg),bt.push({name:"index"})),t.next=13;break;case 12:e.$message.error(s.msg);case 13:case"end":return t.stop()}}),t)})))()}}},ke=xe,Ie=(a("8bcb"),Object(l["a"])(ke,ye,we,!1,null,"32aa447e",null)),_e=Ie.exports,Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"changepassword"}},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"passform",attrs:{model:e.passform,rules:e.passrules,"label-position":"left","label-width":"80px"}},[a("el-form-item",{attrs:{label:"原密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入原密码"},model:{value:e.passform.password,callback:function(t){e.$set(e.passform,"password",t)},expression:"passform.password"}})],1),a("el-form-item",{attrs:{label:"新密码",prop:"newpassword"}},[a("el-input",{attrs:{id:"inputValue",type:"password",placeholder:"请输入新密码"},model:{value:e.passform.newpassword,callback:function(t){e.$set(e.passform,"newpassword",t)},expression:"passform.newpassword"}})],1),a("el-form-item",{staticStyle:{"text-align":"center"},attrs:{label:"密码强度"}},[a("div",{staticClass:"input_span"},[a("span",{staticStyle:{background:"#eee"},attrs:{id:"one"}}),a("span",{staticStyle:{background:"#eee"},attrs:{id:"two"}}),a("span",{staticStyle:{background:"#eee"},attrs:{id:"three"}})]),a("div",{},[a("span",{staticStyle:{"padding-right":"15rem"}},[e._v("弱")]),a("span",{staticStyle:{"padding-right":"15rem"}},[e._v("中")]),a("span",[e._v("强")])])]),a("el-form-item",{attrs:{label:"确认新密码",prop:"checkpassword","label-width":"120px"}},[a("el-input",{attrs:{type:"password",placeholder:"请确认新密码"},model:{value:e.passform.checkpassword,callback:function(t){e.$set(e.passform,"checkpassword",t)},expression:"passform.checkpassword"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",disabled:""==e.passform.password||e.passform.newpassword!=e.passform.checkpassword||""==e.passform.newpassword||""==e.passform.checkpassword},on:{click:e.onSubmit}},[e._v("提交修改")])],1)],1)],1)],1)},De=[],Ne={name:"ChangePassword",data:function(){var e=this,t=function(t,a,s){a!==e.passform.newpassword?s(new Error("请确认新密码")):s()};return{msgText:"",passform:{password:"",newpassword:"",checkpassword:""},userInfo:{},passrules:{password:[{required:!0,message:"请输入原密码",trigger:"blur"}],newpassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:4,max:20,trigger:"blur",message:"密码长度为4到20位"}],checkpassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{validator:t}]}}},watch:{"passform.newpassword":{handler:function(e){this.msgText=this.checkStrong(e),this.msgText>1||1==this.msgText?(document.getElementById("one").style.background="#ff0000",console.log("red")):document.getElementById("one").style.background="#eee",this.msgText>2||2==this.msgText?document.getElementById("two").style.background="orange":document.getElementById("two").style.background="#eee",4==this.msgText?document.getElementById("three").style.background="#00D1B2":document.getElementById("three").style.background="#eee"}}},created:function(){var e=localStorage.getItem("userInfo");e&&(this.userInfo=JSON.parse(e))},methods:{checkStrong:function(e){var t=0;if(e.length<1)return t;switch(/\d/.test(e)&&t++,/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/\W/.test(e)&&t++,t){case 1:return 1;case 2:return 2;case 3:case 4:return e.length<4?3:4}return t},onSubmit:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a,s,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,s=a.userInfo.id,console.log(s),r=new String(s),t.next=6,G(r,a.userInfo.username,a.passform.password,a.passform.newpassword,a.passform.checkpassword);case 6:n=t.sent,"1"===String(n.code)?(a.$message.success(n.msg),localStorage.clear(),sessionStorage.clear(),bt.push("/login")):a.$message.error(n.msg);case 8:case"end":return t.stop()}}),t)})))()}}},Fe=Ne,$e=(a("2940"),Object(l["a"])(Fe,Ce,De,!1,null,null,null)),Oe=$e.exports,Le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container",attrs:{id:"mendian-app"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"tableBar"},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入门店名",clearable:""},on:{clear:e.cleanQuery,blur:e.handleQuery},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{cursor:"pointer"},attrs:{slot:"prefix"},on:{click:e.handleQuery},slot:"prefix"})]),a("el-button",{attrs:{type:"primary",loading:e.dialogFormVisibles},on:{click:function(t){return e.addMemberHandle("add")}}},[e._v(" 添加门店 ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],staticClass:"tableBox",attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"门店名"}}),a("el-table-column",{attrs:{prop:"introduction",label:"门店简介"}}),a("el-table-column",{attrs:{label:"门店状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:"0"===String(t.row.status)?"color: red":"color: #0c56dc"},[e._v(" "+e._s("0"===String(t.row.status)?"休息中":"正在营业")+" ")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"210",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.addMemberHandle(t.row)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteMemberHandle(t.row)}}}),"0"===String(t.row.status)?a("el-button",{attrs:{type:"info",round:""},on:{click:function(a){return e.statusHandle(t.row)}}},[e._v(e._s("1"===String(t.row.status)?"休息":"营业"))]):a("el-button",{attrs:{round:""},on:{click:function(a){return e.statusHandle(t.row)}}},[e._v(e._s("1"===String(t.row.status)?"休息":"营业"))])]}}])})],1),a("el-pagination",{staticClass:"pageList",attrs:{"page-sizes":[5,10,20,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.counts,"current-page":e.page},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{staticStyle:{"z-index":"123412"},attrs:{"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,title:e.addorbianji,visible:e.dialogFormVisibles},on:{"update:visible":function(t){e.dialogFormVisibles=t}}},[a("el-form",{attrs:{rules:e.rules,model:e.form}},[a("el-form-item",{attrs:{label:"(必填) 门店名称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入门店名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"门店简介","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入门店简介"},model:{value:e.form.introduction,callback:function(t){e.$set(e.form,"introduction",t)},expression:"form.introduction"}})],1),a("el-form-item",{attrs:{label:"门店状态","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择门店状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"正在营业",value:"1"}}),a("el-option",{attrs:{label:"休息中",value:"0"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{"margin-right":"10px"},on:{click:e.dialogFormFButton}},[e._v("取 消")]),"add"===e.addoredit?a("span",[a("el-button",{attrs:{type:"warning",plain:"",disabled:""===e.form.name,loading:e.dialogFormButtonLoading},on:{click:e.dialogFormTANDButton}},[e._v("添加并继续添加")]),a("el-button",{attrs:{type:"primary",disabled:""===e.form.name,loading:e.dialogFormButtonLoading},on:{click:e.dialogFormTButton}},[e._v("确 定")])],1):"edit"===e.addoredit?a("span",[a("el-button",{attrs:{type:"primary",disabled:""===e.form.name,loading:e.dialogFormButtonLoading},on:{click:e.dialogFormUpdataButton}},[e._v("更 新")])],1):e._e()],1)],1)],1)])},Be=[],ze={name:"mendianguanli",data:function(){return{formLabelWidth:"",input:"",counts:0,page:1,pageSize:5,addoredit:"add",tableData:[],tableloading:!0,storeid:"",storestatus:"",token:"",userInfo:{},isNeedUpdata:!1,dialogFormVisibles:!1,addorbianji:"添加门店",form:{name:"",introduction:"",status:"1"},dialogFormButtonLoading:!1,rules:{name:[{required:!0,message:"请输入门店名",trigger:"blur"}]}}},computed:{},created:function(){this.userInfo=JSON.parse(localStorage.getItem("userInfo")),this.token=localStorage.getItem("token");var e=window.localStorage.getItem("userInfo");e?1===this.userInfo.permissions?(this.tableloading=!0,this.init()):(this.$message.error("非超级管理员,禁止访问"),window.location.href="../../index.html"):(this.$message.error("身份异常"),window.location.href="../../index.html")},mounted:function(){},methods:{init:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,C(e.page,e.pageSize,e.input?e.input:void 0);case 2:a=t.sent,console.log(a),"1"===String(a.code)?(e.tableData=a.data.records||[],e.counts=Number(a.data.total),e.tableloading=!1,e.isNeedUpdata=!1):e.$message.error("请求出错了："+a.msg);case 5:case"end":return t.stop()}}),t)})))()},handleQuery:function(){this.page=1,this.tableloading=!0,this.init()},cleanQuery:function(){this.input="",this.page=1,this.tableloading=!0,this.init()},addMemberHandle:function(e){"add"===e?(this.addorbianji="添加门店",this.addoredit="add",this.dialogFormVisibles=!0,console.log("添加")):(this.addoredit="edit",this.addorbianji="编辑门店",this.form.name=e.name,this.storeid=e.id,this.form.status=String(e.status),this.form.introduction=e.introduction,this.dialogFormVisibles=!0,console.log("编辑"),console.log(e))},statusHandle:function(e){var t=this;t.storeid=e.id,t.storestatus=e.status,this.$confirm("确认调整该门店的状态?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,A(String(t.userInfo.id),String(t.storeid),String(t.storestatus));case 2:a=e.sent,"1"===String(a.code)?(t.tableloading=!0,t.init(),t.$message.success(a.msg)):t.$message.error(a.msg);case 4:case"end":return e.stop()}}),e)}))))},deleteMemberHandle:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=t,console.log(s.userInfo),a.next=4,q(String(s.userInfo.id),String(e.id));case 4:r=a.sent,"1"===String(r.code)?(s.$message.success(r.msg),s.handleQuery()):s.$message.error(r.msg);case 6:case"end":return a.stop()}}),a)})))()},dialogFormTButton:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,console.log(e.form),e.dialogFormButtonLoading=!0,t.next=5,Y(a.userInfo.id,a.form.name,a.form.introduction,a.form.status);case 5:s=t.sent,"1"===String(s.code)?(a.dialogFormButtonLoading=!1,a.dialogFormVisibles=!1,a.$message.success(s.msg),a.form.name="",a.form.introduction="",e.handleQuery()):(a.$message.error(s.msg),a.dialogFormButtonLoading=!1);case 7:case"end":return t.stop()}}),t)})))()},dialogFormTANDButton:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,Y(a.userInfo.id,a.form.name,a.form.introduction,a.form.status);case 3:s=t.sent,a.dialogFormButtonLoading=!0,"1"===String(s.code)?(a.dialogFormButtonLoading=!1,a.$message.success(s.msg),a.form.name="",a.form.introduction="",a.isNeedUpdata=!0):(a.$message.error(s.msg),a.dialogFormButtonLoading=!1);case 6:case"end":return t.stop()}}),t)})))()},dialogFormUpdataButton:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.dialogFormButtonLoading=!0,t.next=3,ee(String(e.userInfo.id),String(e.storeid),String(e.form.name),String(e.form.introduction),String(e.form.status));case 3:a=t.sent,"1"===String(a.code)?(e.$message.success(a.msg),e.form.status="",e.form.name="",e.form.introduction="",e.storeid="",e.dialogFormVisibles=!1,e.dialogFormButtonLoading=!1,e.tableloading=!0,e.init()):(e.$message.error(a.msg),e.dialogFormButtonLoading=!1);case 5:case"end":return t.stop()}}),t)})))()},dialogFormFButton:function(){this.dialogFormVisibles=!1,this.form.name="",this.form.introduction="",this.dialogFormButtonLoading=!1,this.isNeedUpdata&&this.handleQuery()},handleSizeChange:function(e){this.pageSize=e,this.tableloading=!0,this.init()},handleCurrentChange:function(e){this.page=e,this.tableloading=!0,this.init()}}},Re=ze,je=(a("a7f0"),Object(l["a"])(Re,Le,Be,!1,null,"4e6d2ff8",null)),Te=je.exports,Ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container",attrs:{id:"member-app"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"tableBar"},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入用户名称",clearable:""},on:{clear:e.cleanQuery,blur:e.handleQuery},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{cursor:"pointer"},attrs:{slot:"prefix"},on:{click:e.handleQuery},slot:"prefix"})]),a("el-button",{attrs:{type:"primary",loading:e.dialogFormVisibles},on:{click:function(t){return e.addMemberHandle("add")}}},[e._v(" 添加用户 ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],staticClass:"tableBox",attrs:{data:e.tableData,stripe:"","cell-style":e.rowStyle}},[a("el-table-column",{attrs:{prop:"name",label:"用户名称",align:"center",width:"120"}}),a("el-table-column",{attrs:{prop:"sex",label:"性别",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"phone",label:"手机号",align:"center"}}),a("el-table-column",{attrs:{prop:"idNumber",label:"身份证号",align:"center",width:"180"}}),a("el-table-column",{attrs:{label:"用户状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:"0"===String(t.row.status)?"color: red":"color: #0c56dc"},[e._v(" "+e._s("0"===String(t.row.status)?"禁用":"正常")+" ")])]}}])}),a("el-table-column",{attrs:{label:"权限",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(" "+e._s("1"===String(t.row.permissions)?"超级管理员":"2"===String(t.row.permissions)?"门店管理":"3"===String(t.row.permissions)?"用户":null)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"storeId",label:"绑定门店Id",align:"center",width:"80"}}),a("el-table-column",{attrs:{label:"操作",width:"210",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",disabled:"0"===String(t.row.isAllowOperation)},on:{click:function(a){return e.addMemberHandle(t.row)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",disabled:"0"===String(t.row.isAllowOperation)},on:{click:function(a){return e.deleteMemberHandle(t.row)}}}),"0"===String(t.row.status)?a("el-button",{attrs:{type:"info",round:"",disabled:"0"===String(t.row.isAllowOperation)},on:{click:function(a){return e.statusHandle(t.row)}}},[e._v(e._s("1"===String(t.row.status)?"禁用":"启用"))]):a("el-button",{attrs:{round:"",disabled:"0"===String(t.row.isAllowOperation)},on:{click:function(a){return e.statusHandle(t.row)}}},[e._v(e._s("1"===String(t.row.status)?"禁用":"启用"))])]}}])})],1),a("el-pagination",{staticClass:"pageList",attrs:{"page-sizes":[5,10,20,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.counts,"current-page":e.page},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("transition",{attrs:{name:"el-zoom-in-center"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.show2,expression:"show2"}],staticClass:"transition-box"},[a("el-dialog",{staticStyle:{"z-index":"2065"},attrs:{"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,title:e.addorbianji,visible:e.dialogFormVisibles},on:{"update:visible":function(t){e.dialogFormVisibles=t}}},[a("el-form",{attrs:{rules:e.rules,model:e.form}},[a("div",{staticClass:"onecard",attrs:{id:"onecard1"}},[a("div",{staticStyle:{display:"flex"}},[a("el-form-item",{attrs:{label:"用户名","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入用户用户名"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("span",{staticStyle:{width:"50px"}}),a("el-form-item",{attrs:{label:"用户名称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入用户名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("span",{staticStyle:{width:"50px"}}),a("el-form-item",{attrs:{label:"性别","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择用户性别"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[a("el-option",{attrs:{label:"男",value:"男"}}),a("el-option",{attrs:{label:"女",value:"女"}})],1)],1)],1),a("div",{staticStyle:{display:"flex"}},[a("el-form-item",{attrs:{label:"手机号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入用户手机号"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("span",{staticStyle:{width:"50px"}}),a("el-form-item",{attrs:{label:"证件号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入用户身份证号"},model:{value:e.form.idNumber,callback:function(t){e.$set(e.form,"idNumber",t)},expression:"form.idNumber"}})],1),a("span",{staticStyle:{width:"50px"}}),e.isNeedPasswordInput?a("el-form-item",{attrs:{label:"初始密码","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入初始密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1):e._e()],1)]),a("div",{staticClass:"onecard",staticStyle:{"margin-bottom":"0px"}},[a("div",{staticStyle:{display:"flex"}},[a("el-form-item",{attrs:{label:"状态","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择用户状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"正常",value:"1"}}),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),a("span",{staticStyle:{width:"50px"}}),a("el-form-item",{attrs:{label:"权限","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择用户权限"},on:{change:e.permissionsChange},model:{value:e.form.permissions,callback:function(t){e.$set(e.form,"permissions",t)},expression:"form.permissions"}},e._l(e.employeeoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",[a("el-form-item",{attrs:{label:"绑定门店Id","label-width":e.formLabelWidth}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择绑定门店Id"},model:{value:e.form.storeId,callback:function(t){e.$set(e.form,"storeId",t)},expression:"form.storeId"}},e._l(e.storeoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("span",{staticStyle:{width:"50px"}}),a("span",{staticStyle:{"font-family":"'Leelawadee UI Semilight'","font-size":"12px","margin-left":"10px"}},[e._v(" 注:权限为门店管理或者用户必须绑定此项，否则无法成功提交 ")])],1)],1)])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{"margin-right":"10px"},on:{click:e.dialogFormFButton}},[e._v("取 消")]),"add"===e.addoredit?a("span",[a("el-button",{attrs:{type:"warning",plain:"",disabled:""===e.form.name||""===e.form.permissions||""===e.form.sex||""===e.form.idNumber||""===e.form.phone||""===e.form.status||""===e.form.username,loading:e.dialogFormButtonLoading},on:{click:e.dialogFormTANDButton}},[e._v("添加并继续添加")]),a("el-button",{attrs:{type:"primary",disabled:""===e.form.name||""===e.form.permissions||""===e.form.sex||""===e.form.idNumber||""===e.form.phone||""===e.form.status||""===e.form.username,loading:e.dialogFormButtonLoading},on:{click:e.dialogFormTButton}},[e._v("确 定")])],1):"edit"===e.addoredit?a("span",[a("el-button",{attrs:{type:"primary",disabled:""===e.form.name||""===e.form.permissions||""===e.form.sex||""===e.form.idNumber||""===e.form.phone||""===e.form.status||""===e.form.username,loading:e.dialogFormButtonLoading},on:{click:e.dialogFormUpdataButton}},[e._v("更 新")])],1):e._e()],1)],1)],1)])],1)])},He=[],qe={name:"memberguanli",el:"#member-app",data:function(){return{formLabelWidth:"",input:"",counts:0,page:1,pageSize:5,addoredit:"add",tableData:[],tableloading:!0,userid:"",userstatus:"",token:"",storeoptions:[{value:"1",label:"某某店(Id:1)"}],employeeoptions:[{value:"3",label:"门店员工"}],userInfo:{},isNeedUpdata:!1,dialogFormVisibles:!1,isNeedPasswordInput:!1,addorbianji:"添加用户",form:{name:"",username:"",phone:"",idNumber:"",status:"1",permissions:"",storeId:"",sex:"",password:"123456"},dialogFormButtonLoading:!1,rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}]}}},computed:{},created:function(){this.userInfo=JSON.parse(localStorage.getItem("userInfo")),this.token=localStorage.getItem("token");var e=window.localStorage.getItem("userInfo");e?1===this.userInfo.permissions||2===this.userInfo.permissions?(this.tableloading=!0,this.init()):(this.$message.error("非超级管理员,禁止访问"),window.location.href="../../index.html"):(this.$message.error("身份异常"),window.location.href="../../index.html")},mounted:function(){},methods:{init:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,D(e.page,e.pageSize,e.input?e.input:void 0);case 2:return a=t.sent,console.log(a),"1"===String(a.code)?(e.tableData=a.data.records||[],e.counts=Number(a.data.total),e.tableloading=!1,e.isNeedUpdata=!1):e.$message.error("请求出错了："+a.msg),t.next=7,U();case 7:return s=t.sent,"1"===String(s.code)&&(e.employeeoptions=s.data),t.next=11,E();case 11:r=t.sent,"1"===String(r.code)&&(e.storeoptions=r.data);case 13:case"end":return t.stop()}}),t)})))()},handleQuery:function(){this.page=1,this.tableloading=!0,this.init()},cleanQuery:function(){this.input="",this.page=1,this.tableloading=!0,this.init()},addMemberHandle:function(e){"add"===e?(this.addorbianji="添加用户",this.addoredit="add",this.dialogFormVisibles=!0,this.isNeedPasswordInput=!0,console.log("添加")):(this.isNeedPasswordInput=!1,this.addoredit="edit",this.addorbianji="编辑用户",this.form.name=e.name,this.userid=e.id,this.form.status=String(e.status),this.form.idNumber=String(e.idNumber),this.form.phone=String(e.phone),this.form.username=String(e.username),this.dialogFormVisibles=!0,this.form.sex=String(e.sex),this.form.permissions=String(e.permissions),this.form.storeId=String(e.storeId),console.log("编辑"),console.log(e))},statusHandle:function(e){var t=this;t.userid=e.id,t.userstatus=e.status,this.$confirm("确认调整该用户的状态?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,H(String(t.userid),String(t.userInfo.id),String(t.userstatus));case 2:a=e.sent,"1"===String(a.code)?(t.tableloading=!0,t.init(),t.$message.success(a.msg)):t.$message.error(a.msg);case 4:case"end":return e.stop()}}),e)}))))},deleteMemberHandle:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=t,console.log(s.userInfo),a.next=4,V(String(e.id),String(s.userInfo.id));case 4:r=a.sent,"1"===String(r.code)?(s.$message.success(r.msg),s.handleQuery()):s.$message.error(r.msg);case 6:case"end":return a.stop()}}),a)})))()},cleanform:function(){this.form.status="",this.form.name="",this.form.username="",this.form.sex="",this.form.phone="",this.form.permissions="",this.form.storeId=null,this.form.idNumber="",this.userid="",this.userstatus=""},dialogFormTButton:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,console.log(e.form),e.dialogFormButtonLoading=!0,t.next=5,te(a.form);case 5:s=t.sent,"1"===String(s.code)?(a.dialogFormButtonLoading=!1,a.dialogFormVisibles=!1,a.$message.success(s.msg),a.cleanform(),e.handleQuery()):(a.$message.error(s.msg),a.dialogFormButtonLoading=!1);case 7:case"end":return t.stop()}}),t)})))()},dialogFormTANDButton:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,te(a.form);case 3:s=t.sent,a.dialogFormButtonLoading=!0,"1"===String(s.code)?(a.dialogFormButtonLoading=!1,a.$message.success(s.msg),a.cleanform(),a.isNeedUpdata=!0):(a.$message.error(s.msg),a.dialogFormButtonLoading=!1);case 6:case"end":return t.stop()}}),t)})))()},permissionsChange:function(){"1"===String(this.form.permissions)?this.form.storeId=null:""!==this.form.storeId&&void 0!=this.form.storeId&&null!==this.form.storeId||(this.form.storeId=void 0)},dialogFormUpdataButton:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.dialogFormButtonLoading=!0,t.next=3,se(e.form,String(e.userid));case 3:a=t.sent,"1"===String(a.code)?(e.$message.success(a.msg),e.cleanform(),e.dialogFormVisibles=!1,e.dialogFormButtonLoading=!1,e.tableloading=!0,e.init()):(e.$message.error(a.msg),e.dialogFormButtonLoading=!1);case 5:case"end":return t.stop()}}),t)})))()},dialogFormFButton:function(){this.dialogFormVisibles=!1,this.cleanform(),this.dialogFormButtonLoading=!1,this.isNeedUpdata&&this.handleQuery()},handleSizeChange:function(e){this.pageSize=e,this.tableloading=!0,this.init()},handleCurrentChange:function(e){this.page=e,this.tableloading=!0,this.init()},rowStyle:function(){return"text-align:center"}}},Ve=qe,Ee=(a("9e4e"),Object(l["a"])(Ve,Ae,He,!1,null,"4f6b4cd7",null)),Ue=Ee.exports,Qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container",attrs:{id:"category-app"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"xuanzeqi"},[a("el-tag",{attrs:{effect:"plain"}},[e._v(" 门店ID ")]),a("el-select",{staticStyle:{"margin-left":"10px"},attrs:{filterable:"",placeholder:"请选择门店ID",disabled:!e.isAdmin},on:{change:e.changeStoreId},model:{value:e.storeIdvalue,callback:function(t){e.storeIdvalue=t},expression:"storeIdvalue"}},e._l(e.storeIdoptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1),a("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{effect:"plain"}},[e._v(" 门店名称 ")]),a("el-select",{staticStyle:{"margin-left":"10px"},attrs:{filterable:"",placeholder:"门店Name",disabled:""},model:{value:e.storeNamevalue,callback:function(t){e.storeNamevalue=t},expression:"storeNamevalue"}})],1),a("div",{staticClass:"tableBar",staticStyle:{display:"inline-block"}},[a("el-button",{staticClass:"continue",attrs:{type:"primary"},on:{click:e.addClass}},[e._v(" + 新增分类 ")])],1),a("el-table",{staticClass:"tableBox",attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"分类名称"}}),a("el-table-column",{attrs:{prop:"type",label:"分类类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s("1"==t.row.type?"菜品分类":"套餐分类"))])]}}])}),a("el-table-column",{attrs:{prop:"updateTime",label:"操作时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.updateTime)+" ")]}}])}),a("el-table-column",{attrs:{prop:"sort",label:"排序"}}),a("el-table-column",{attrs:{label:"操作",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"blueBug",attrs:{type:"text",size:"small"},on:{click:function(a){return e.editHandle(t.row)}}},[e._v(" 修改 ")]),a("el-button",{staticClass:"delBut non",attrs:{type:"text",size:"small"},on:{click:function(a){return e.deleteHandle(t.row.id)}}},[e._v(" 删除 ")])]}}])})],1),a("el-pagination",{staticClass:"pageList",attrs:{"page-sizes":[5,10,20,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.counts},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:e.classData.title,visible:e.classData.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){return e.$set(e.classData,"dialogVisible",t)}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"分类名称："}},[a("el-input",{attrs:{placeholder:"请输入分类名称",maxlength:"14"},model:{value:e.classData.name,callback:function(t){e.$set(e.classData,"name",t)},expression:"classData.name"}})],1),a("el-form-item",{attrs:{label:"分类类型："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.classData.type,callback:function(t){e.$set(e.classData,"type",t)},expression:"classData.type"}},e._l(e.typeoptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"排序："}},[a("el-input",{attrs:{type:"number",placeholder:"请输入排序"},model:{value:e.classData.sort,callback:function(t){e.$set(e.classData,"sort",t)},expression:"classData.sort"}})],1),a("el-tag",{attrs:{type:"success"}},[e._v("默认按照排序从小到大排序,出现重复则按名称首字母从小到大")])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){e.classData.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.submitForm()}}},[e._v("确 定")]),"edit"!=e.action?a("el-button",{staticClass:"continue",attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.submitForm("go")}}},[e._v(" 保存并继续添加 ")]):e._e()],1)],1)],1)},Me=[],Je={name:"category",data:function(){return{action:"",counts:0,page:1,pageSize:5,tableData:[],userInfo:{},token:"",isAdmin:!1,storeIdoptions:[],storeNamevalue:"",storeIdvalue:"",classData:{title:"添加菜品分类",dialogVisible:!1,categoryId:"",name:"",sort:"",type:"1"},typeoptions:[{label:"菜品分类",value:"1"},{label:"套餐分类",value:"2"}]}},computed:{},created:function(){this.userInfo=JSON.parse(localStorage.getItem("userInfo")),this.token=localStorage.getItem("token");var e=window.localStorage.getItem("userInfo");e?"1"===String(this.userInfo.permissions)?(this.isAdmin=!0,this.getStoreListOnlyIdWithName()):(this.storeIdvalue=String(this.userInfo.storeId),this.getStoreById(),this.isAdmin=!1,this.init()):(this.$message.error("身份异常"),window.location.href="../../index.html")},mounted:function(){},methods:{changeStoreId:function(){this.getStoreById(),this.init()},getStoreById:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ae(e.storeIdvalue);case 2:a=t.sent,"1"===String(a.code)&&(e.storeNamevalue=a.data.name);case 4:case"end":return t.stop()}}),t)})))()},getStoreListOnlyIdWithName:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,E();case 2:a=t.sent,"1"===String(a.code)&&(e.storeIdoptions=a.data,""===e.storeNamevalue&&(e.storeIdvalue=a.data[0].value,""!==sessionStorage.getItem("userLastStoreId")&&(e.storeIdvalue=sessionStorage.getItem("userLastStoreId")),e.getStoreById(),e.init()));case 4:case"end":return t.stop()}}),t)})))()},init:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return sessionStorage.setItem("userLastStoreId",e.storeIdvalue),t.next=3,P(String(e.page),String(e.pageSize),String(e.storeIdvalue));case 3:a=t.sent,"1"===String(a.code)?(e.tableData=a.data.records,e.counts=Number(a.data.total)):e.$message.error(a.msg);case 5:case"end":return t.stop()}}),t)})))()},handleQuery:function(){this.page=1,this.init()},addClass:function(){""===this.storeIdvalue&&this.isAdmin?this.$message.info("请先选择门店!"):""!==this.storeIdvalue?(this.classData.title="新增分类",this.action="add",this.classData.name="",this.classData.sort="",this.classData.dialogVisible=!0):this.$message.error("请刷新重试!")},editHandle:function(e){this.classData.title="修改分类",this.action="edit",this.classData.name=e.name,this.classData.sort=e.sort,this.classData.id=e.id,this.classData.type=String(e.type),this.classData.dialogVisible=!0},handleClose:function(e){console.log(e),this.classData.dialogVisible=!1},deleteHandle:function(e){var t=this;console.log(e),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(g["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,x(e);case 2:s=a.sent,"1"===String(s.code)?(t.$message.success(s.msg),t.handleQuery()):t.$message.error(s.msg);case 4:case"end":return a.stop()}}),a)}))))},submitForm:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var s,r,n,o,i,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(console.log(e),s=t.classData,r=(0===s.name||s.name)&&(0===s.sort||s.sort),"add"!==t.action){a.next=19;break}if(!r){a.next=16;break}if(n=/^\d+$/,!n.test(s.sort)){a.next=13;break}return a.next=9,Q(String(s.type),String(s.name),String(s.sort),String(t.storeIdvalue));case 9:o=a.sent,"1"===String(o.code)?(t.$message.success("分类添加成功！"),e?(t.classData.name="",t.classData.sort=""):t.classData.dialogVisible=!1,t.handleQuery()):t.$message.error(o.msg||"操作失败"),a.next=14;break;case 13:t.$message.error("排序只能输入数字类型");case 14:a.next=17;break;case 16:t.$message.error("请输入分类名称或排序");case 17:a.next=32;break;case 19:if(!r){a.next=31;break}if(i=/^\d+$/,!i.test(t.classData.sort)){a.next=28;break}return a.next=24,J(String(t.classData.id),String(t.classData.type),String(t.classData.name),String(t.classData.sort));case 24:l=a.sent,"1"===String(l.code)?(t.$message.success(l.msg),t.classData.dialogVisible=!1,t.handleQuery()):t.$message.error(l.msg),a.next=29;break;case 28:t.$message.error("排序只能输入数字类型");case 29:a.next=32;break;case 31:t.$message.error("请输入分类名称或排序");case 32:case"end":return a.stop()}}),a)})))()},handleSizeChange:function(e){this.pageSize=e,this.init()},handleCurrentChange:function(e){this.page=e,this.init()}}},Pe=Je,We=(a("60f8"),Object(l["a"])(Pe,Qe,Me,!1,null,null,null)),Ke=We.exports,Ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container",attrs:{id:"food-app"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"xuanzeqi"},[a("el-tag",{attrs:{effect:"plain"}},[e._v(" 门店ID ")]),a("el-select",{staticStyle:{"margin-left":"10px"},attrs:{filterable:"",placeholder:"请选择门店ID",disabled:!e.isAdmin},on:{change:e.changeStoreId},model:{value:e.storeIdvalue,callback:function(t){e.storeIdvalue=t},expression:"storeIdvalue"}},e._l(e.storeIdoptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1),a("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{effect:"plain"}},[e._v(" 门店名称 ")]),a("el-select",{staticStyle:{"margin-left":"10px"},attrs:{filterable:"",placeholder:"门店Name",disabled:""},model:{value:e.storeNamevalue,callback:function(t){e.storeNamevalue=t},expression:"storeNamevalue"}})],1),a("div",{staticClass:"tableBar"},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入菜品名称",clearable:""},on:{clear:e.cleanQuery},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{cursor:"pointer"},attrs:{slot:"prefix"},on:{click:e.init},slot:"prefix"})]),a("div",{staticClass:"tableLab"},[a("span",{staticClass:"span-btn delBut non",on:{click:function(t){return e.deleteHandle("批量",null)}}},[e._v("批量删除")]),a("span",{staticClass:"span-btn blueBug non",on:{click:function(t){return e.statusHandle("1")}}},[e._v("批量启售")]),a("span",{staticClass:"span-btn delBut non",staticStyle:{border:"none"},on:{click:function(t){return e.statusHandle("0")}}},[e._v("批量停售")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addFoodtype("add")}}},[e._v(" + 新建菜品 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.foodtableloading,expression:"foodtableloading"}],staticClass:"tableBox",attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"25"}}),a("el-table-column",{attrs:{prop:"name",label:"菜品名称",width:"90"}}),a("el-table-column",{attrs:{prop:"image",label:"图片",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("el-image",{staticStyle:{width:"auto",height:"40px",border:"none",cursor:"pointer"},attrs:{src:t.image,"preview-src-list":[""+t.image]}})]}}])}),a("el-table-column",{attrs:{prop:"categoryName",label:"菜品分类",width:"120"}}),a("el-table-column",{attrs:{label:"售价",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-right":"10px"}},[e._v("￥"+e._s(t.row.price))])]}}])}),a("el-table-column",{attrs:{label:"售卖状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:"0"===String(t.row.status)?"color: red;margin-right: 10px;":"color: #0c56dc;margin-right: 10px;"},[e._v(e._s("0"==t.row.status?"停售":"启售"))])]}}])}),a("el-table-column",{attrs:{label:"排序",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.row.sort))])]}}])}),a("el-table-column",{attrs:{prop:"updateTime",label:"最后操作时间"}}),a("el-table-column",{attrs:{label:"操作",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"blueBug",attrs:{type:"text",size:"small"},on:{click:function(a){return e.addFoodtype(t.row)}}},[e._v(" 修改 ")]),a("el-button",{staticClass:"blueBug",attrs:{type:"text",size:"small"},on:{click:function(a){return e.statusHandle(t.row)}}},[e._v(" "+e._s("0"==t.row.status?"启售":"停售")+" ")]),a("el-button",{staticClass:"delBut non",attrs:{type:"text",size:"small"},on:{click:function(a){return e.deleteHandle("单删",t.row.id)}}},[e._v(" 删除 ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[5,10,20,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.counts},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("div",[a("el-dialog",{staticStyle:{"z-index":"2100"},attrs:{title:e.classData.title,visible:e.classData.dialogVisible,width:"80%","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0},on:{"update:visible":function(t){return e.$set(e.classData,"dialogVisible",t)}}},[a("el-form",{ref:"classData",staticClass:"demo-classData",attrs:{model:e.classData,rules:e.rules,inline:!0,"label-width":"180px"}},[a("div",[a("el-form-item",{attrs:{label:"菜品名称:",prop:"name"}},[a("el-input",{attrs:{placeholder:"请填写菜品名称",maxlength:"20"},model:{value:e.classData.name,callback:function(t){e.$set(e.classData,"name",t)},expression:"classData.name"}})],1),a("el-form-item",{attrs:{label:"菜品分类：",prop:"categoryId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.classData.categoryId,callback:function(t){e.$set(e.classData,"categoryId",t)},expression:"classData.categoryId"}},e._l(e.categoryIdoptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",[a("el-form-item",{attrs:{label:"菜品价格:",prop:"price"}},[a("el-input",{attrs:{placeholder:"请设置菜品价格"},model:{value:e.classData.price,callback:function(t){e.$set(e.classData,"price",t)},expression:"classData.price"}})],1),a("el-form-item",{attrs:{label:"排序："}},[a("el-input",{attrs:{type:"number",placeholder:"请输入排序"},model:{value:e.classData.sort,callback:function(t){e.$set(e.classData,"sort",t)},expression:"classData.sort"}})],1),a("el-tag",{attrs:{type:"success"}},[e._v("默认按照排序从小到大排序,出现重复则按名称首字母从小到大")])],1),a("el-form-item",{attrs:{label:"口味做法配置:"}},[a("el-form-item",[a("div",{staticClass:"flavorBox"},[0==e.dishFlavors.length?a("span",{staticClass:"addBut",on:{click:e.addFlavore}},[e._v(" + 添加口味")]):e._e(),0!=e.dishFlavors.length?a("div",{staticClass:"flavor"},[a("div",{staticClass:"title"},[a("span",[e._v("口味名（3个字内）")]),a("span",[e._v("口味标签（输入标签回车添加）")])]),a("div",{staticClass:"cont"},e._l(e.dishFlavors,(function(t,s){return a("div",{key:s,staticClass:"items"},[a("div",{staticClass:"itTit"},[a("div",{staticClass:"selectInput"},[a("div",[a("el-input",{staticStyle:{width:"100%","text-align":"center"},attrs:{type:"text",placeholder:"请输入口味"},on:{focus:function(t){return e.selectFlavor(!0,s)},blur:function(t){return e.outSelect(!1,s)}},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showOption,expression:"item.showOption"}],staticClass:"flavorSelect"},[e._l(e.dishFlavorsData,(function(t,r){return a("el-button",{key:r,staticClass:"items",attrs:{type:"primary",plain:""},on:{click:function(a){return e.checkOption(t,r,s)}}},[e._v(e._s(t.name)+" ")])})),e.dishFlavorsData==[]?a("span",{staticClass:"none"},[e._v("无数据 ")]):e._e()],2)])]),a("div",{staticClass:"labItems",staticStyle:{display:"flex"}},[e._l(t.value,(function(t,r){return a("span",{key:r},[e._v(e._s(t)+" "),a("i",{on:{click:function(t){return e.delFlavorLabel(s,r)}}},[e._v("X")])])})),a("div",{staticClass:"inputBox",style:e.inputStyle,attrs:{contenteditable:"true"},on:{focus:function(t){return e.flavorPosition(s)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:function(t){return e.keyDownHandle(t,s)}(t)}}})],2),a("span",{staticClass:"delFlavor delBut non",on:{click:function(t){return e.delFlavor(s)}}},[e._v("删除")])])})),0),a("div",{staticClass:"addBut",on:{click:e.addFlavore}},[e._v(" 添加口味 ")])]):e._e()])])],1),a("div"),a("div",[a("el-form-item",{staticClass:"uploadImg",attrs:{label:"菜品图片:",prop:"region"}},[a("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.isimageupload,expression:"isimageupload"}],ref:"upload",staticClass:"avatar-uploader",attrs:{action:"http://localhost:8081/api/common/uploadimage",headers:e.headerObj,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeUpload}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"售卖状态："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.classData.status,callback:function(t){e.$set(e.classData,"status",t)},expression:"classData.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"address"},[a("el-form-item",{attrs:{label:"菜品描述:",prop:"region"}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"菜品描述，最长200字",maxlength:"200"},model:{value:e.classData.description,callback:function(t){e.$set(e.classData,"description",t)},expression:"classData.description"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.cancel()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.submitForm()}}},[e._v("确 定")]),"edit"!=e.action?a("el-button",{staticClass:"continue",attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.submitForm("go")}}},[e._v(" 保存并继续添加 ")]):e._e()],1)],1)],1)],1)])},Xe=[],Ge=(a("a4d3"),a("e01a"),a("a15b"),a("1276"),a("498a"),a("2909")),Ye=a("ba9f"),et={name:"food",data:function(){return{headerObj:{Authorization:localStorage.getItem("token"),userid:localStorage.getItem("userid")},input:"",counts:0,page:1,pageSize:5,tableData:[],dishState:"",checkList:[],foodtableloading:!1,userInfo:{},token:"",isAdmin:!1,storeIdoptions:[],storeNamevalue:"",storeIdvalue:"",categoryIdoptions:[],classData:{id:"",title:"新建菜品",dialogVisible:!1,foodId:"",name:"",sort:"",status:"1",categoryId:"",price:"",image:"",description:"",version:""},statusoptions:[{label:"上架",value:"1"},{label:"停售",value:"0"}],action:"",imageUrl:"",dishList:[],dishFlavorsData:[],inputStyle:{flex:1},dishFlavors:[],imgBase64:"",waterMakeConfig:{font:"microsoft yahei",textArray:["rg"]},isimageupload:!1}},computed:{rules:function(){return{name:[{required:!0,message:"请填写菜品名称",trigger:"blur"}],categoryId:[{required:!0,message:"请选择菜品分类",trigger:"change"}],price:[{required:!0,validator:function(e,t,a){if(t){var s=/^\d+(\.\d{0,2})?$/;s.test(t)?t<1e4?a():a(new Error("菜品价格小于10000")):a(new Error("菜品价格格式只能为数字,且最多保留两位小数"))}else a(new Error("请填写菜品价格"))},trigger:"blur"}]}}},created:function(){this.userInfo=JSON.parse(localStorage.getItem("userInfo")),this.token=localStorage.getItem("token");var e=window.localStorage.getItem("userInfo");e?"1"===String(this.userInfo.permissions)?(this.isAdmin=!0,this.getStoreListOnlyIdWithName()):(this.storeIdvalue=String(this.userInfo.storeId),this.getStoreById(),this.isAdmin=!1,this.init()):(this.$message.error("身份异常"),window.location.href="../../index.html")},mounted:function(){},methods:{getCategoryIdoptions:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,W(String(e.storeIdvalue),String("1"));case 2:a=t.sent,"1"===String(a.code)?(console.log(a),e.categoryIdoptions=a.data):e.$message.error(a.msg);case 4:case"end":return t.stop()}}),t)})))()},changeStoreId:function(){this.getStoreById(),this.init()},getStoreById:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ae(e.storeIdvalue);case 2:a=t.sent,"1"===String(a.code)&&(e.storeNamevalue=a.data.name);case 4:case"end":return t.stop()}}),t)})))()},getStoreListOnlyIdWithName:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,E();case 2:a=t.sent,"1"===String(a.code)&&(e.storeIdoptions=a.data,""===e.storeNamevalue&&(e.storeIdvalue=a.data[0].value,""!==sessionStorage.getItem("userLastStoreId")&&(e.storeIdvalue=sessionStorage.getItem("userLastStoreId")),e.getStoreById(),e.init()));case 4:case"end":return t.stop()}}),t)})))()},init:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return sessionStorage.setItem("userLastStoreId",e.storeIdvalue),e.foodtableloading=!0,e.getFlavorListHand(),t.next=5,N(e.page,e.pageSize,e.storeIdvalue,e.input?e.input:void 0);case 5:a=t.sent,"1"===String(a.code)?(e.tableData=a.data.records||[],e.counts=Number(a.data.total)):e.$message.error(a.msg),e.foodtableloading=!1;case 8:case"end":return t.stop()}}),t)})))()},getImage:function(e){return e},handleQuery:function(){this.page=1,this.init()},cleanQuery:function(){this.page=1,this.input=void 0,this.init()},addFoodtype:function(e){console.log(e),""===this.storeIdvalue&&this.isAdmin?this.$message.info("请先选择门店!"):""!==this.storeIdvalue?(this.getCategoryIdoptions(),"add"===e?(this.action="add",this.cleanform(),this.classData.title="新增菜品",this.classData.dialogVisible=!0):(this.action="edit",this.classData.title="编辑菜品",this.classData.id=String(e.id),this.classData.name=String(e.name),this.classData.categoryId=String(e.categoryId),this.classData.sort=String(e.sort),this.classData.price=String(e.price),this.classData.status=String(e.status),this.classData.description=String(e.description),this.classData.image=String(e.image),this.imageUrl=String(e.image),this.classData.version=String(e.version),this.getFoodFlavor(e.id),this.classData.dialogVisible=!0)):this.$message.error("请刷新重试!")},deleteHandle:function(e,t){var a=this,s={};if("批量"===e&&null===t&&0===this.checkList.length)return this.$message.error("请选择删除对象");s.id=String("批量"===e?this.checkList.join(","):t),this.$confirm("确认删除该菜品, 是否继续?","确定删除",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,B(s);case 2:t=e.sent,"1"===String(t.code)?(a.$message.success(t.msg),a.handleQuery()):a.$message.error(t.msg||"操作失败");case 4:case"end":return e.stop()}}),e)}))))},statusHandle:function(e){var t=this,a={};if("string"===typeof e){if(0===this.checkList.length)return this.$message.error("批量操作，请先勾选操作菜品！"),!1;a.id=this.checkList.join(","),a.status=e}else a.id=e.id,a.status="1"===String(e.status)?"0":"1";this.dishState=a,this.$confirm("确认更改该菜品状态?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O(t.dishState);case 2:a=e.sent,"1"===String(a.code)?(t.$message.success(a.msg),t.handleQuery()):t.$message.error("请求出错了："+a.msg);case 4:case"end":return e.stop()}}),e)}))))},handleSelectionChange:function(e){var t=[];e.forEach((function(e){t.push(e.id)})),this.checkList=t},handleSizeChange:function(e){console.log(e),this.pageSize=e,this.init()},handleCurrentChange:function(e){e>Number(this.counts)/Number(this.pageSize)+1?this.$message.info("最大页了"):(this.page=e,this.init())},checkOption:function(e,t,a){this.selectHandle(e.name,a,t),this.dishFlavors[a].name=e.name},addFlavore:function(){var e=this;this.dishFlavors.length>=3?this.$prompt("不建议口味数超过3(为了用户端体验),若您仍要继续请输入[继续]","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(t){var a=t.value;"继续"===a&&e.dishFlavors.push({name:"",value:[],showOption:!1})})).catch((function(){})):this.dishFlavors.push({name:"",value:[],showOption:!1})},delFlavor:function(e){this.dishFlavors.splice(e,1)},delFlavorLabel:function(e,t){this.dishFlavors[e].value.splice(t,1)},flavorPosition:function(e){this.index=e},keyDownHandle:function(e,t){console.log("keyDownHandle----val",e),console.log("keyDownHandle----index",t),console.log("keyDownHandle----this.dishFlavors",this.dishFlavors),event&&(event.cancelBubble=!0,event.preventDefault(),event.stopPropagation()),""!=e.target.innerText.trim()&&(this.dishFlavors[t].value.push(e.target.innerText),e.target.innerText="")},getFlavorListHand:function(){this.dishFlavorsData=[{name:"甜味",value:["无糖","少糖","半糖","多糖","全糖"]},{name:"温度",value:["热饮","常温","去冰","少冰","多冰"]},{name:"忌口",value:["不要葱","不要蒜","不要香菜","不要辣"]},{name:"辣度",value:["不辣","微辣","中辣","重辣"]}]},cleanform:function(){this.classData.sort="",this.classData.name="",this.classData.image="",this.imageUrl="",this.classData.price="",this.classData.description="",this.classData.categoryId="",this.dishFlavors=[]},selectFlavor:function(e,t){console.log("st",e),console.log("index",t),console.log("this.dishFlavors",this.dishFlavors);var a=JSON.parse(JSON.stringify(this.dishFlavors[t]));a.showOption=e,this.dishFlavors.splice(t,1,a)},outSelect:function(e,t){var a=this;setTimeout((function(){var s=JSON.parse(JSON.stringify(a.dishFlavors[t]));s.showOption=e,a.dishFlavors.splice(t,1,s)}),200)},cancel:function(){this.cleanform(),this.classData.dialogVisible=!1},selectHandle:function(e,t,a){var s=Object(Ge["a"])(this.dishFlavors);s[t]=JSON.parse(JSON.stringify(this.dishFlavorsData[a])),this.dishFlavors=s},beforeUpload:function(e){this.isimageupload=!0;var t=e.name.split(".")[1],a=e.size/1024/1024<8;if(!["png","jpeg","jpg"].includes(String(t)))return this.$message.error("上传图片只支持 png、jpeg、jpg 格式！"),this.$refs.upload.clearFiles(),!1;a||this.$message.error("上传文件大小超过 8MB，将会被强制压缩");var s=a;return new Promise((function(t){s&&t(e),Ye["compressAccurately"](e,8192).then((function(e){console.log(e),t(e)}))}))},handleAvatarSuccess:function(e,t,a){console.log(t),console.log(a),"1"===String(e.code)?(this.imageUrl=e.data,this.classData.image=e.data):(this.imageUrl="",this.classData.image="",this.$message.error(e.msg)),this.isimageupload=!1,this.$refs.upload.clearFiles()},submitForm:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var s,r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("go"!==e||"add"!==t.action){a.next=8;break}return console.log(t.dishFlavors),a.next=4,K(t.classData.name,t.classData.categoryId,String(t.classData.price),t.classData.image,t.classData.description,String(t.classData.status),String(t.classData.sort),t.storeIdvalue,t.dishFlavors);case 4:s=a.sent,"1"===String(s.code)?(console.log(s),t.$message.success(s.msg),t.cleanform()):t.$message.error(s.msg),a.next=22;break;case 8:if("add"!==t.action){a.next=16;break}return console.log(t.dishFlavors),a.next=12,K(t.classData.name,t.classData.categoryId,String(t.classData.price),t.classData.image,t.classData.description,String(t.classData.status),String(t.classData.sort),t.storeIdvalue,t.dishFlavors);case 12:r=a.sent,"1"===String(r.code)?(console.log(r),t.$message.success(r.msg),t.cleanform(),t.handleQuery(),t.dialogVisible=!1):t.$message.error(r.msg),a.next=22;break;case 16:if("edit"!==t.action){a.next=22;break}return console.log("edit"),a.next=20,X(t.classData.name,t.classData.categoryId,String(t.classData.price),t.classData.image,t.classData.description,String(t.classData.status),String(t.classData.sort),t.storeIdvalue,t.dishFlavors,String(t.classData.id),String(t.classData.version));case 20:n=a.sent,"1"===String(n.code)?(console.log(n),t.$message.success(n.msg),t.cancel(),t.handleQuery()):t.$message.error(n.msg);case 22:case"end":return a.stop()}}),a)})))()},getFoodFlavor:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var s,r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s={},s.id=String(e),a.next=4,R(s);case 4:if(r=a.sent,"1"===String(r.code))for(t.dishFlavors=r.data,console.log(r.data.length),n=0;n<r.data.length;n++)o=r.data[n].value,console.log("0:"+o),o=o.replace(/\[|]/g,""),console.log("1:"+o),t.dishFlavors[n].value=o.split(", "),console.log("2:"+t.dishFlavors[n].value);case 6:case"end":return a.stop()}}),a)})))()}}},tt=et,at=(a("b0ff"),Object(l["a"])(tt,Ze,Xe,!1,null,"647ad2c2",null)),st=at.exports,rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container",attrs:{id:"combo-app"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"xuanzeqi"},[a("el-tag",{attrs:{effect:"plain"}},[e._v(" 门店ID ")]),a("el-select",{staticStyle:{"margin-left":"10px"},attrs:{filterable:"",placeholder:"请选择门店ID",disabled:!e.isAdmin},on:{change:e.changeStoreId},model:{value:e.storeIdvalue,callback:function(t){e.storeIdvalue=t},expression:"storeIdvalue"}},e._l(e.storeIdoptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1),a("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{effect:"plain"}},[e._v(" 门店名称 ")]),a("el-select",{staticStyle:{"margin-left":"10px"},attrs:{filterable:"",placeholder:"门店Name",disabled:""},model:{value:e.storeNamevalue,callback:function(t){e.storeNamevalue=t},expression:"storeNamevalue"}})],1),a("div",{staticClass:"tableBar"},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入套餐名称",clearable:""},on:{clear:e.cleanQuery},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{cursor:"pointer"},attrs:{slot:"prefix"},on:{click:e.init},slot:"prefix"})]),a("div",{staticClass:"tableLab"},[a("span",{staticClass:"span-btn delBut non",on:{click:function(t){return e.deleteHandle("批量")}}},[e._v("批量删除")]),a("span",{staticClass:"span-btn blueBug non",on:{click:function(t){return e.statusHandle("1")}}},[e._v("批量启售")]),a("span",{staticClass:"span-btn delBut non",staticStyle:{border:"none"},on:{click:function(t){return e.statusHandle("0")}}},[e._v("批量停售")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addSetMeal("add")}}},[e._v(" + 新建套餐 ")])],1)],1),a("el-table",{staticClass:"tableBox",attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"60"}}),a("el-table-column",{attrs:{prop:"name",label:"套餐名称",width:"120"}}),a("el-table-column",{attrs:{prop:"image",label:"图片",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("el-image",{staticStyle:{width:"auto",height:"40px",border:"none",cursor:"pointer"},attrs:{src:t.image,"preview-src-list":[""+t.image]}})]}}])}),a("el-table-column",{attrs:{prop:"categoryName",label:"套餐分类",width:"130"}}),a("el-table-column",{attrs:{prop:"price",label:"套餐价",width:"130"}}),a("el-table-column",{attrs:{label:"售卖状态",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:"0"===String(t.row.status)?"color: red;margin-right: 10px;":"color: #0c56dc;margin-right: 10px;"},[e._v(e._s("0"==t.row.status?"停售":"启售"))])]}}])}),a("el-table-column",{attrs:{prop:"sort",label:"排序",width:"100"}}),a("el-table-column",{attrs:{prop:"updateTime",label:"最后操作时间"}}),a("el-table-column",{attrs:{prop:"description",label:"套餐描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{placement:"top","open-delay":500,effect:"dark",disabled:!t.row.showTooltip},model:{value:t.row.showTooltip,callback:function(a){e.$set(t.row,"showTooltip",a)},expression:"scope.row.showTooltip"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.row.description))]),a("div",{staticClass:"myNote",on:{mouseenter:function(a){return e.showTips(a,t.row)}}},[e._v(e._s(t.row.description))])])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"blueBug",attrs:{type:"text",size:"small"},on:{click:function(a){return e.addSetMeal(t.row)}}},[e._v(" 修改 ")]),a("el-button",{staticClass:"blueBug",attrs:{type:"text",size:"small"},on:{click:function(a){return e.statusHandle(t.row)}}},[e._v(" "+e._s("0"==t.row.status?"启售":"停售")+" ")]),a("el-button",{staticClass:"delBut non",attrs:{type:"text",size:"small"},on:{click:function(a){return e.deleteHandle("单删",t.row.id)}}},[e._v(" 删除 ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[5,10,20,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.counts},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("div",[a("el-dialog",{staticStyle:{"z-index":"2100"},attrs:{title:e.classData.title,visible:e.classData.dialogVisible,width:"95%","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0},on:{"update:visible":function(t){return e.$set(e.classData,"dialogVisible",t)}}},[a("el-form",{ref:"classData",staticClass:"demo-classData",attrs:{model:e.classData,rules:e.rules,inline:!0,"label-width":"120px"}},[a("div",[a("el-form-item",{attrs:{label:"套餐名称:",prop:"name"}},[a("el-input",{attrs:{placeholder:"请填写套餐名称",maxlength:"20"},model:{value:e.classData.name,callback:function(t){e.$set(e.classData,"name",t)},expression:"classData.name"}})],1),a("el-form-item",{attrs:{label:"套餐分类：",prop:"categoryId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.classData.categoryId,callback:function(t){e.$set(e.classData,"categoryId",t)},expression:"classData.categoryId"}},e._l(e.categoryIdoptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"售卖状态："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.classData.status,callback:function(t){e.$set(e.classData,"status",t)},expression:"classData.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",[a("el-form-item",{attrs:{label:"套餐价格:",prop:"price"}},[a("el-input",{attrs:{placeholder:"请设置套餐价格"},model:{value:e.classData.price,callback:function(t){e.$set(e.classData,"price",t)},expression:"classData.price"}})],1),a("el-form-item",{attrs:{label:"排序："}},[a("el-input",{attrs:{type:"number",placeholder:"请输入排序"},model:{value:e.classData.sort,callback:function(t){e.$set(e.classData,"sort",t)},expression:"classData.sort"}})],1),a("el-form-item",{attrs:{label:"套餐描述:",prop:"region"}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"套餐描述，最长200字",maxlength:"200"},model:{value:e.classData.description,callback:function(t){e.$set(e.classData,"description",t)},expression:"classData.description"}})],1)],1),a("div",[a("el-form-item",{staticClass:"uploadImg",attrs:{label:"套餐图片:",prop:"region"}},[a("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.isimageupload,expression:"isimageupload"}],ref:"upload",staticClass:"avatar-uploader",attrs:{action:"http://localhost:8081/api/common/uploadimage",headers:e.headerObj,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeUpload}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{staticClass:"setmealFood",attrs:{label:"套餐菜品:"}},[a("el-form-item",[a("div",{staticClass:"addDish"},[0==e.dishTable.length?a("span",{staticClass:"addBut",on:{click:e.openAddDish}},[e._v(" + 添加菜品")]):e._e(),0!=e.dishTable.length?a("div",{staticClass:"content"},[a("div",{staticClass:"addBut",staticStyle:{"margin-bottom":"20px"},on:{click:e.openAddDish}},[e._v("+ 添加菜品")]),a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dishTable}},[a("el-table-column",{attrs:{prop:"image",label:"图片",width:"50"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{attrs:{src:e.row.image}})]}}],null,!1,538588431)}),a("el-table-column",{attrs:{prop:"name",label:"名称",width:"180",align:"center"}}),a("el-table-column",{attrs:{prop:"price",label:"原价",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(Number(t.row.price))+" ")]}}],null,!1,4268913554)}),a("el-table-column",{attrs:{prop:"address",label:"份数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{attrs:{size:"small",min:1,max:99,label:"描述文字"},model:{value:t.row.copies,callback:function(a){e.$set(t.row,"copies",a)},expression:"scope.row.copies"}})]}}],null,!1,1483850948)}),a("el-table-column",{attrs:{prop:"address",label:"操作",width:"180px;",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.delDishHandle(t.$index)}}},[e._v(" 删除 ")])]}}],null,!1,3080629240)})],1)],1)]):e._e()])])],1)],1),a("el-form-item",{attrs:{label:"口味做法配置:"}},[a("el-form-item",[a("div",{staticClass:"flavorBox"},[0==e.setmealFlavors.length?a("span",{staticClass:"addBut",on:{click:e.addFlavore}},[e._v(" + 添加口味")]):e._e(),0!=e.setmealFlavors.length?a("div",{staticClass:"flavor"},[a("div",{staticClass:"title"},[a("span",[e._v("口味名（3个字内）")]),a("span",[e._v("口味标签（输入标签回车添加）")])]),a("div",{staticClass:"cont"},e._l(e.setmealFlavors,(function(t,s){return a("div",{key:s,staticClass:"items"},[a("div",{staticClass:"itTit"},[a("div",{staticClass:"selectInput"},[a("div",[a("el-input",{staticStyle:{width:"100%","text-align":"center"},attrs:{type:"text",placeholder:"请输入口味"},on:{focus:function(t){return e.selectFlavor(!0,s)},blur:function(t){return e.outSelect(!1,s)}},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showOption,expression:"item.showOption"}],staticClass:"flavorSelect"},[e._l(e.setmealFlavorsData,(function(t,r){return a("el-button",{key:r,staticClass:"items",attrs:{type:"primary",plain:""},on:{click:function(a){return e.checkOption(t,r,s)}}},[e._v(e._s(t.name)+" ")])})),e.setmealFlavorsData==[]?a("span",{staticClass:"none"},[e._v("无数据 ")]):e._e()],2)])]),a("div",{staticClass:"labItems",staticStyle:{display:"flex"}},[e._l(t.value,(function(t,r){return a("span",{key:r},[e._v(e._s(t)+" "),a("i",{on:{click:function(t){return e.delFlavorLabel(s,r)}}},[e._v("X")])])})),a("div",{staticClass:"inputBox",style:e.inputStyle,attrs:{contenteditable:"true"},on:{focus:function(t){return e.flavorPosition(s)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:function(t){return e.keyDownHandle(t,s)}(t)}}})],2),a("span",{staticClass:"delFlavor delBut non",on:{click:function(t){return e.delFlavor(s)}}},[e._v("删除")])])})),0),a("div",{staticClass:"addBut",on:{click:e.addFlavore}},[e._v(" 添加口味 ")])]):e._e()])])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.cancel()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.submitForm()}}},[e._v("确 定")]),"edit"!=e.action?a("el-button",{staticClass:"continue",attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.submitForm("go")}}},[e._v(" 保存并继续添加 ")]):e._e()],1),a("el-dialog",{staticClass:"addDishList",staticStyle:{"z-index":"2101"},attrs:{title:"添加菜品",visible:e.dish.dialogVisible,width:"80%","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0},on:{"update:visible":function(t){return e.$set(e.dish,"dialogVisible",t)}}},[a("el-input",{staticClass:"seachDish",staticStyle:{width:"250px"},attrs:{placeholder:"请输入菜品名称进行搜索",size:"small",clearable:""},on:{clear:function(t){return e.dishSeachHandle("q")}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dishSeachHandle(t)}},model:{value:e.dishvalue,callback:function(t){e.dishvalue=t},expression:"dishvalue"}},[a("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{cursor:"pointer"},attrs:{slot:"prefix"},on:{click:e.dishSeachHandle},slot:"prefix"})]),a("div",{staticClass:"addDishCon"},[a("div",{staticClass:"leftCont"},[a("div",{directives:[{name:"show",rawName:"v-show",value:""==e.seachKey.trim(),expression:"seachKey.trim() == ''"}],staticClass:"tabBut"},e._l(e.dishType,(function(t,s){return a("span",{key:s,class:{act:s==e.keyInd},on:{click:function(a){return e.dishCheckTypeHandle(s,t.value)}}},[e._v(e._s(t.label))])})),0),a("div",{staticClass:"tabList"},[a("div",{staticClass:"table"},[0==e.dishAddList.length?a("div",{staticStyle:{"padding-left":"10px"}},[e._v(" 暂无菜品! ")]):e._e(),e.dishAddList.length>0?a("el-checkbox-group",{on:{change:e.dishCheckedListHandle},model:{value:e.dishCheckedList,callback:function(t){e.dishCheckedList=t},expression:"dishCheckedList"}},e._l(e.dishAddList,(function(t,s){return a("div",{key:s,staticClass:"items"},[a("el-checkbox",{key:s,attrs:{label:t}},[a("div",{staticClass:"item"},[a("span",{staticStyle:{flex:"3","text-align":"left"}},[e._v(e._s(t.dishName))]),a("span",[e._v(e._s(0==t.status?"停售":"在售"))]),a("span",[e._v(e._s(Number(t.price)))])])])],1)})),0):e._e()],1)])]),a("div",{staticClass:"ritCont"},[a("div",{staticClass:"tit"},[e._v(" 已选菜品("+e._s(e.dishCheckedList.length)+") ")]),a("div",{staticClass:"items"},e._l(e.dishCheckedList,(function(t,s){return a("div",{key:s,staticClass:"item"},[a("span",[e._v(e._s(t.dishName))]),a("span",{staticClass:"price"},[e._v("￥ "+e._s(Number(t.price))+" ")]),a("span",{staticClass:"del",on:{click:function(t){return e.delCheck(s)}}})])})),0)])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.dishHandleClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addDishTableList}},[e._v("确 定")])],1)],1)],1)],1)])},nt=[],ot={name:"combo.vue",data:function(){return{headerObj:{Authorization:localStorage.getItem("token"),userid:localStorage.getItem("userid")},input:"",dishvalue:"",keyInd:0,seachKey:"",dishType:[],dishAddList:[],dishCheckedList:[],dishTable:[],dishCheckList:[],setmealFlavorsData:[],inputStyle:{flex:1},setmealFlavors:[],counts:0,page:1,pageSize:10,tableData:[],dishState:"",checkList:[],isAdmin:!1,storeIdoptions:[],storeNamevalue:"",storeIdvalue:"",categoryIdoptions:[],imageUrl:"",classData:{id:"",title:"新建套餐",dialogVisible:!1,foodId:"",name:"",sort:"",status:"1",categoryId:"",price:"",image:"",description:"",version:"",code:"",dishResults:[],storeId:"",setmealFlavors:[]},dish:{dialogVisible:!1},isimageupload:!1,action:"add",statusoptions:[{label:"上架",value:"1"},{label:"停售",value:"0"}]}},computed:{rules:function(){return{name:[{required:!0,message:"请填写套餐名称",trigger:"blur"}],categoryId:[{required:!0,message:"请选择套餐分类",trigger:"change"}],price:[{required:!0,validator:function(e,t,a){if(t){var s=/^\d+(\.\d{0,2})?$/;s.test(t)?t<1e4?a():a(new Error("套餐价格小于10000")):a(new Error("套餐价格格式只能为数字,且最多保留两位小数"))}else a(new Error("请填写套餐价格"))},trigger:"blur"}]}}},watch:{checkList:function(e){this.checkedList=e}},created:function(){this.userInfo=JSON.parse(localStorage.getItem("userInfo")),this.token=localStorage.getItem("token");var e=window.localStorage.getItem("userInfo");e?"1"===String(this.userInfo.permissions)?(this.isAdmin=!0,this.getStoreListOnlyIdWithName()):(this.storeIdvalue=String(this.userInfo.storeId),this.classData.storeId=String(this.userInfo.storeId),this.getStoreById(),this.isAdmin=!1,this.init()):(this.$message.error("身份异常"),window.location.href="../../index.html")},mounted:function(){},methods:{getCategoryIdoptions:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,W(String(e.storeIdvalue),String("2"));case 2:a=t.sent,"1"===String(a.code)?(console.log(a),e.categoryIdoptions=a.data):e.$message.error(a.msg);case 4:case"end":return t.stop()}}),t)})))()},changeStoreId:function(){this.classData.storeId=this.storeIdvalue,this.getStoreById(),this.init()},getStoreById:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ae(e.storeIdvalue);case 2:a=t.sent,"1"===String(a.code)&&(e.storeNamevalue=a.data.name);case 4:case"end":return t.stop()}}),t)})))()},cleanform:function(){this.classData.sort="",this.classData.name="",this.classData.image="",this.classData.setmealFlavors=[],this.setmealFlavors=[],this.imageUrl="",this.classData.price="",this.classData.description="",this.dishCheckedList=[],this.dishTable=[],this.dishCheckList=[]},getDishForName:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,F(void 0,t.storeIdvalue,e);case 2:if(s=a.sent,"1"!==String(s.code)){a.next=10;break}if(0!=s.data.length){a.next=7;break}return t.dishAddList=[],a.abrupt("return");case 7:r=s.data,r.forEach((function(e){e.dishId=e.id,e.copies=1,e.dishName=e.name})),t.dishAddList=r;case 10:case"end":return a.stop()}}),a)})))()},openAddDish:function(){this.seachKey="",this.dish.dialogVisible=!0,this.dishvalue="",this.keyInd=0,this.getDishList(this.dishType[0].value)},getDishType:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,W(String(e.storeIdvalue),String("1"));case 2:a=t.sent,"1"===String(a.code)?(console.log("type:"+a),e.dishType=a.data,e.getDishList(a.data[0].value)):e.$message.error(a.msg);case 4:case"end":return t.stop()}}),t)})))()},getCheckList:function(e){this.dishCheckedList=Object(Ge["a"])(e),console.log("获取添加菜品数据"+this.dishCheckedList)},dishCheckedListHandle:function(){this.getCheckList(this.dishCheckedList)},dishHandleClose:function(){this.dish.dialogVisible=!1},addDishTableList:function(){var e=this,t=JSON.parse(JSON.stringify(this.dishCheckedList));console.log(t),void 0!==t&&t.forEach((function(t){t.copies=1,e.dishTable.push(t)})),this.dish.dialogVisible=!1,this.dishCheckList=[]},dishSeachHandle:function(e){"q"===e?(this.seachKey="",this.getDishForName(this.seachKey)):(this.seachKey=this.dishvalue,this.getDishForName(this.seachKey))},dishCheckTypeHandle:function(e,t){this.keyInd=e,this.getDishList(t)},getDishList:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,F(e,t.storeIdvalue,"");case 2:if(s=a.sent,"1"!==String(s.code)){a.next=10;break}if(0!=s.data.length){a.next=7;break}return t.dishAddList=[],a.abrupt("return");case 7:r=s.data,r.forEach((function(e){e.dishId=e.id,e.copies=1,e.dishName=e.name})),t.dishAddList=r;case 10:case"end":return a.stop()}}),a)})))()},getStoreListOnlyIdWithName:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,E();case 2:a=t.sent,"1"===String(a.code)&&(e.storeIdoptions=a.data,""===e.storeNamevalue&&(e.storeIdvalue=a.data[0].value,""!==sessionStorage.getItem("userLastStoreId")&&(e.storeIdvalue=sessionStorage.getItem("userLastStoreId")),e.storeId=a.data[0].value,e.getStoreById(),e.init()));case 4:case"end":return t.stop()}}),t)})))()},init:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getFlavorListHand(),sessionStorage.setItem("userLastStoreId",e.storeIdvalue),t.next=4,$(e.page,e.pageSize,e.storeIdvalue,e.input?e.input:void 0);case 4:a=t.sent,console.log(a),"1"===String(a.code)?"1"===String(a.code)&&("没有数据哦"===a.msg?(e.$message.success(a.msg),e.tableData=[],e.counts=0):(e.tableData=a.data.records||[],e.counts=Number(a.data.total))):e.$message.error("请求出错了："+a.msg),e.getDishType();case 8:case"end":return t.stop()}}),t)})))()},getImage:function(e){return"".concat(e)},handleQuery:function(){this.page=1,this.init()},cleanQuery:function(){this.page=1,this.input=void 0,this.init()},deleteHandle:function(e,t){var a=this,s={};if("批量"===e&&null===t&&0===this.checkList.length)return this.$message.error("请选择删除对象");s.id=String("批量"===e?this.checkList.join(","):t),this.$confirm("确定删除该套餐, 是否继续?","确定删除",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(Object(g["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,z(s);case 2:t=e.sent,"1"===String(t.code)?(a.$message.success("删除成功！"),a.handleQuery()):a.$message.error(t.msg||"操作失败");case 4:case"end":return e.stop()}}),e)}))))},statusHandle:function(e){var t=this,a={};if("string"===typeof e){if(0==this.checkList.length)return this.$message.error("批量操作，请先勾选操作套餐！"),!1;a.ids=this.checkList.join(","),a.status=e}else a.ids=e.id,a.status="1"===String(e.status)?"0":"1";this.$confirm("确认更改该套餐状态?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(g["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,L(a);case 2:s=e.sent,"1"===String(s.code)?(t.$message.success(s.msg),t.handleQuery()):t.$message.error(s.msg||"操作失败");case 4:case"end":return e.stop()}}),e)}))))},handleSelectionChange:function(e){var t=[];e.forEach((function(e){t.push(e.id)})),this.checkList=t},handleSizeChange:function(e){this.pageSize=e,this.init()},handleCurrentChange:function(e){this.page=e,this.init()},showTips:function(e,t){var a=document.createElement("span");a.innerText=t.description,a.className="getTextWidth",document.querySelector("body").appendChild(a);var s=document.querySelector(".getTextWidth").offsetWidth;document.querySelector(".getTextWidth").remove();var r=e.target.offsetWidth;t.showTooltip=!(s<=2*r)},handleAvatarSuccess:function(e,t,a){console.log(t),console.log(a),"1"===String(e.code)?(this.imageUrl=e.data,this.classData.image=e.data):(this.imageUrl="",this.classData.image="",this.$message.error(e.msg)),this.isimageupload=!1,this.$refs.upload.clearFiles()},beforeUpload:function(e){this.isimageupload=!0;var t=e.name.split(".")[1],a=e.size/1024/1024<8;if(!["png","jpeg","jpg"].includes(String(t)))return this.$message.error("上传图片只支持 png、jpeg、jpg 格式！"),this.$refs.upload.clearFiles(),!1;a||this.$message.error("上传文件大小超过 8MB，将会被强制压缩");var s=a;return new Promise((function(t){s&&t(e),Ye["compressAccurately"](e,8192).then((function(e){console.log(e),t(e)}))}))},addSetMeal:function(e){console.log(e),""===this.storeIdvalue&&this.isAdmin?this.$message.info("请先选择门店!"):""!==this.storeIdvalue?(this.getCategoryIdoptions(),"add"===e?(this.action="add",this.cleanform(),this.classData.title="新增套餐",this.classData.dialogVisible=!0):(this.action="edit",this.classData.title="编辑套餐",this.classData.id=String(e.id),this.classData.name=String(e.name),this.classData.categoryId=String(e.categoryId),this.classData.sort=String(e.sort),this.classData.price=String(e.price),this.classData.status=String(e.status),this.classData.description=String(e.description),this.classData.image=String(e.image),this.imageUrl=String(e.image),this.classData.version=String(e.version),this.getSetmealDish(e.id),this.getSetmealFlavor(e.id),this.classData.dialogVisible=!0)):this.$message.error("请刷新重试!")},submitForm:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var s,r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.classData.storeId=String(t.storeIdvalue),"go"!==e||"add"!==t.action){a.next=13;break}return console.log(t.dishTable),console.log(t.classData),console.log(t.dishCheckList),t.classData.dishResults=t.dishTable,t.classData.setmealFlavors=t.setmealFlavors,a.next=9,M(t.classData);case 9:s=a.sent,"1"===String(s.code)?(console.log(s),t.$message.success(s.msg),t.cleanform(),t.handleQuery()):t.$message.error(s.msg),a.next=45;break;case 13:if("add"!==t.action){a.next=25;break}return console.log(t.dishTable),console.log(t.classData),console.log(t.dishCheckList),t.classData.dishResults=t.dishTable,t.classData.setmealFlavors=t.setmealFlavors,a.next=21,M(t.classData);case 21:r=a.sent,"1"===String(r.code)?(console.log(r),t.$message.success(r.msg),t.cleanform(),t.handleQuery(),t.classData.dialogVisible=!1):t.$message.error(r.msg),a.next=45;break;case 25:if("edit"!==t.action){a.next=45;break}return n={},n.categoryId=t.classData.categoryId,n.description=t.classData.description,n.id=t.classData.id,n.image=t.classData.image,n.name=t.classData.name,n.price=t.classData.price,n.sort=t.classData.sort,n.status=t.classData.status,n.setmealFlavors=t.setmealFlavors,n.storeId=t.classData.storeId,n.version=t.classData.version,n.code=t.classData.code,n.dishResults=t.dishTable,console.log("edit"),a.next=43,Z(n);case 43:o=a.sent,"1"===String(o.code)?(t.$message.success(o.msg),t.cancel(),t.handleQuery()):t.$message.error(o.msg);case 45:case"end":return a.stop()}}),a)})))()},cancel:function(){this.classData.dialogVisible=!1,this.cleanform()},checkOption:function(e,t,a){this.selectHandle(e.name,a,t),this.setmealFlavors[a].name=e.name},addFlavore:function(){var e=this;this.setmealFlavors.length>=3?this.$prompt("不建议口味数超过3(为了用户端体验),若您仍要继续请输入[继续]","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(t){var a=t.value;"继续"===a&&e.setmealFlavors.push({name:"",value:[],showOption:!1})})).catch((function(){})):this.setmealFlavors.push({name:"",value:[],showOption:!1})},delFlavor:function(e){this.setmealFlavors.splice(e,1)},delFlavorLabel:function(e,t){this.setmealFlavors[e].value.splice(t,1)},flavorPosition:function(e){this.index=e},keyDownHandle:function(e,t){console.log("keyDownHandle----val",e),console.log("keyDownHandle----index",t),console.log("keyDownHandle----this.setmealFlavors",this.setmealFlavors),event&&(event.cancelBubble=!0,event.preventDefault(),event.stopPropagation()),""!=e.target.innerText.trim()&&(this.setmealFlavors[t].value.push(e.target.innerText),e.target.innerText="")},getFlavorListHand:function(){this.setmealFlavorsData=[{name:"甜味",value:["无糖","少糖","半糖","多糖","全糖"]},{name:"温度",value:["热饮","常温","去冰","少冰","多冰"]},{name:"忌口",value:["不要葱","不要蒜","不要香菜","不要辣"]},{name:"辣度",value:["不辣","微辣","中辣","重辣"]}]},selectFlavor:function(e,t){console.log("st",e),console.log("index",t),console.log("this.setmealFlavors",this.setmealFlavors);var a=JSON.parse(JSON.stringify(this.setmealFlavors[t]));a.showOption=e,this.setmealFlavors.splice(t,1,a)},selectHandle:function(e,t,a){var s=Object(Ge["a"])(this.setmealFlavors);s[t]=JSON.parse(JSON.stringify(this.setmealFlavorsData[a])),this.setmealFlavors=s},outSelect:function(e,t){var a=this;setTimeout((function(){var s=JSON.parse(JSON.stringify(a.setmealFlavors[t]));s.showOption=e,a.setmealFlavors.splice(t,1,s)}),200)},delDishHandle:function(e){this.dishTable.splice(e,1),this.dishCheckList.splice(e,1)},getSetmealFlavor:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var s,r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s={},s.id=String(e),a.next=4,T(s);case 4:if(r=a.sent,"1"===String(r.code))for(t.setmealFlavors=r.data,console.log(r.data.length),n=0;n<r.data.length;n++)o=r.data[n].value,console.log("0:"+o),o=o.replace(/\[|]/g,""),console.log("1:"+o),t.setmealFlavors[n].value=o.split(", "),console.log("2:"+t.setmealFlavors[n].value);case 6:case"end":return a.stop()}}),a)})))()},getSetmealDish:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var s,r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s={},s.id=e,a.next=4,j(s);case 4:r=a.sent,"1"===String(r.code)?(n=r.data,n.forEach((function(e){e.dishId=e.id,e.dishName=e.name})),t.dishTable=n):t.$message.error(r.msg);case 6:case"end":return a.stop()}}),a)})))()}}},it=ot,lt=(a("22f2"),Object(l["a"])(it,rt,nt,!1,null,null,null)),ct=lt.exports,ut=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container",attrs:{id:"mendian-app"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"xuanzeqi"},[a("el-tag",{attrs:{effect:"plain"}},[e._v(" 门店ID ")]),a("el-select",{staticStyle:{"margin-left":"10px"},attrs:{filterable:"",placeholder:"请选择门店ID",disabled:!e.isAdmin},on:{change:e.changeStoreId},model:{value:e.storeIdvalue,callback:function(t){e.storeIdvalue=t},expression:"storeIdvalue"}},e._l(e.storeIdoptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1),a("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{effect:"plain"}},[e._v(" 门店名称 ")]),a("el-select",{staticStyle:{"margin-left":"10px"},attrs:{filterable:"",placeholder:"门店Name",disabled:""},model:{value:e.storeNamevalue,callback:function(t){e.storeNamevalue=t},expression:"storeNamevalue"}})],1),a("el-table",{staticClass:"tableBox",attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{prop:"id",label:"订单号",width:"90"}}),a("el-table-column",{attrs:{prop:"orderTime",label:"下单时间"}}),a("el-table-column",{attrs:{prop:"consignee",label:"收货人",width:"90"}}),a("el-table-column",{attrs:{prop:"address",label:"收货地址",width:"120","show-overflow-tooltip":"true"}}),a("el-table-column",{attrs:{prop:"phone",label:"手机号",width:"120"}}),a("el-table-column",{attrs:{label:"支付方式",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"===String(t.row.payMethod)?a("span",{staticStyle:{"margin-right":"10px"}},[e._v("支付宝")]):"1"===String(t.row.payMethod)?a("span",{staticStyle:{"margin-right":"10px"}},[e._v("微信支付")]):e._e()]}}])}),a("el-table-column",{attrs:{label:"付款状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"===String(t.row.payStatus)?a("span",{staticStyle:{"margin-right":"10px"}},[e._v("已付款")]):"1"===String(t.row.payStatus)?a("span",{staticStyle:{"margin-right":"10px"}},[e._v("未付款")]):e._e()]}}])}),a("el-table-column",{attrs:{label:"实收金额",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.row.amount))])]}}])}),a("el-table-column",{attrs:{label:"订单状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"===String(t.row.orderStatus)?a("span",{staticStyle:{"margin-right":"10px"}},[e._v("待派送")]):"1"===String(t.row.orderStatus)?a("span",{staticStyle:{"margin-right":"10px"}},[e._v("未支付")]):"3"===String(t.row.orderStatus)?a("span",{staticStyle:{"margin-right":"10px"}},[e._v("派送中")]):"4"===String(t.row.orderStatus)?a("span",{staticStyle:{"margin-right":"10px"}},[e._v("已完成")]):"5"===String(t.row.orderStatus)?a("span",{staticStyle:{"margin-right":"10px"}},[e._v("已取消")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"statusRemark",label:"状态备注",width:"120"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注",width:"120"}}),a("el-table-column",{attrs:{prop:"checkoutTime",label:"付款时间"}}),a("el-table-column",{attrs:{label:"操作",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"blueBug",attrs:{type:"text",size:"small"},on:{click:function(a){return e.addFoodtype(t.row)}}},[e._v(" 修改 ")]),"1"===String(t.row.orderStatus)?a("el-button",{staticClass:"delBut non",attrs:{type:"text",size:"small"},on:{click:function(a){return e.changeOrdersSta(t.row,5)}}},[e._v(" 取消订单 ")]):"2"===String(t.row.orderStatus)?a("el-button",{staticClass:"delBut non",attrs:{type:"text",size:"small"},on:{click:function(a){return e.changeOrdersSta(t.row,3)}}},[e._v(" 派送 ")]):"3"===String(t.row.orderStatus)?a("el-button",{staticClass:"delBut non",attrs:{type:"text",size:"small"},on:{click:function(a){return e.changeOrdersSta(t.row,4)}}},[e._v(" 已送达(模拟) ")]):e._e()]}}])})],1),a("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[5,10,20,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.counts},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])},dt=[],mt={name:"orders",data:function(){return{counts:0,page:1,pageSize:5,isAdmin:!1,storeIdoptions:[],storeNamevalue:"",storeIdvalue:"",tableData:[{id:"123412345235233434",orderTime:"2023-02-03 20:30:12",consignee:"桃桃",address:"地址测试",phone:"13988884444",payMethod:"2",payStatus:"2",amount:"12.33",orderStatus:"2",statusRemark:"12312312312312",remark:"w3erw234rt234tw34",checkoutTime:"2023-02-03 20:30:12"},{id:"123412345235233434",orderTime:"2023-02-03 20:30:12",consignee:"桃桃",address:"地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试地址测试",phone:"13988884444",payMethod:"2",payStatus:"2",amount:"12.33",orderStatus:"2",statusRemark:"12312312312312",remark:"w3erw234rt234tw34",checkoutTime:"2023-02-03 20:30:12"},{id:"123412345235233434",orderTime:"2023-02-03 20:30:12",consignee:"桃桃",address:"地址测试",phone:"13988884444",payMethod:"2",payStatus:"2",amount:"12.33",orderStatus:"2",statusRemark:"12312312312312",remark:"w3erw234rt234tw34",checkoutTime:"2023-02-03 20:30:12"}]}},created:function(){this.userInfo=JSON.parse(localStorage.getItem("userInfo")),this.token=localStorage.getItem("token");var e=window.localStorage.getItem("userInfo");e?"1"===String(this.userInfo.permissions)?(this.isAdmin=!0,this.getStoreListOnlyIdWithName()):(this.storeIdvalue=String(this.userInfo.storeId),this.getStoreById(),this.isAdmin=!1,this.init()):(this.$message.error("身份异常"),window.location.href="../../index.html")},methods:{changeOrdersSta:function(e,t){console.log("====================="),console.log("开始改变"),console.log(e),console.log(t)},changeStoreId:function(){this.getStoreById(),this.init()},getStoreById:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ae(e.storeIdvalue);case 2:a=t.sent,"1"===String(a.code)&&(e.storeNamevalue=a.data.name);case 4:case"end":return t.stop()}}),t)})))()},getStoreListOnlyIdWithName:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,E();case 2:a=t.sent,"1"===String(a.code)&&(e.storeIdoptions=a.data,""===e.storeNamevalue&&(e.storeIdvalue=a.data[0].value,""!==sessionStorage.getItem("userLastStoreId")&&(e.storeIdvalue=sessionStorage.getItem("userLastStoreId")),e.getStoreById(),e.init()));case 4:case"end":return t.stop()}}),t)})))()},init:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:sessionStorage.setItem("userLastStoreId",e.storeIdvalue),e.getListForAdmin();case 2:case"end":return t.stop()}}),t)})))()},getListForAdmin:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,I(e.page,e.pageSize,e.storeIdvalue);case 2:a=t.sent,"1"===String(a.code)?(e.tableData=a.data.records,e.counts=Number(a.data.total)):e.$message.error(a.msg);case 4:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){console.log(e),this.pageSize=e,this.init()},handleCurrentChange:function(e){e>Number(this.counts)/Number(this.pageSize)+1?this.$message.info("最大页了"):(this.page=e,this.init())}}},pt=mt,gt=Object(l["a"])(pt,ut,dt,!1,null,"81ccffee",null),ht=gt.exports,ft=[{path:"/",component:u,meta:{requireAuth:!1,needrole:!1},children:[{path:"",redirect:"/login",meta:{requireAuth:!1,needrole:!1}}]},{path:"/login",name:"login",component:Se,meta:{requireAuth:!1,needrole:!1}},{path:"/404",name:"NotFound",component:ie,meta:{requireAuth:!1,needrole:!1}},{path:"/index",name:"index",component:pe,meta:{requireAuth:!0,needrole:!1},children:[{path:"/userinfo",name:"userinfo",component:_e,meta:{requireAuth:!0,needrole:!1}},{path:"/changepassword",name:"changepassword",component:Oe,meta:{requireAuth:!0,needrole:!1}},{path:"/mendianguanli",name:"mendianguanli",component:Te,meta:{requireAuth:!0,needrole:!0,roles:[1]}},{path:"/memberguanli",name:"memberguanli",component:Ue,meta:{requireAuth:!0,needrole:!0,roles:[1,2]}},{path:"/category",name:"category",component:Ke,meta:{requireAuth:!0,needrole:!0,roles:[1,2,3]}},{path:"/food",name:"food",component:st,meta:{requireAuth:!0,needrole:!0,roles:[1,2,3]}},{path:"/combo",name:"combo",component:ct,meta:{requireAuth:!0,needrole:!0,roles:[1,2,3]}},{path:"/orders",name:"orders",component:ht,meta:{requireAuth:!0,needrole:!0,roles:[1,2,3]}}]},{path:"*",name:"404NotFound",redirect:"/404",meta:{requireAuth:!1,needrole:!1}}];s["default"].use(d["a"]);var vt=new d["a"]({mode:"history",routes:ft});vt.beforeEach((function(e,t,a){if(e.meta.requireAuth)if(localStorage.getItem("token")){if(e.meta.needrole){console.log(e.meta.roles),console.log(localStorage.getItem("type"));var s=e.meta.roles,r=localStorage.getItem("type");console.log(s.includes(Number(r))),s.includes(Number(r))?(console.log("存在"),a()):vt.push({path:"/404"})}a()}else a({path:"/login",query:{redirect:e.fullPath}});else a()}));var bt=vt,St=a("2f62");s["default"].use(St["a"]);var yt=new St["a"].Store({state:{},mutations:{},actions:{},modules:{}}),wt=a("5c96"),xt=a.n(wt),kt=(a("0fae"),a("21af"),a("b751"),{isNeedZoom:!1});s["default"].config.productionTip=!1,s["default"].prototype.$globl=kt,s["default"].use(xt.a),new s["default"]({router:bt,store:yt,render:function(e){return e(u)}}).$mount("#app")},"5b90":function(e,t,a){},"5c0b":function(e,t,a){"use strict";var s=a("9c0c"),r=a.n(s);r.a},"60f8":function(e,t,a){"use strict";var s=a("4703"),r=a.n(s);r.a},"8bcb":function(e,t,a){"use strict";var s=a("c168"),r=a.n(s);r.a},"9c0c":function(e,t,a){},"9e4e":function(e,t,a){"use strict";var s=a("350f"),r=a.n(s);r.a},a7f0:function(e,t,a){"use strict";var s=a("3ad2"),r=a.n(s);r.a},ac2f:function(e,t,a){},b0ff:function(e,t,a){"use strict";var s=a("2b00"),r=a.n(s);r.a},b751:function(e,t,a){},c168:function(e,t,a){}});
//# sourceMappingURL=app.f8356583.js.map